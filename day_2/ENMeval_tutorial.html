<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jamie M. Kass, Robert Muscarella, Gonzalo E. Pinilla-Buitrago, and Peter J. Galante. Adapted by Thomas J. Smith">

<title>ENMeval 2.0 tutorial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ENMeval_tutorial_files/libs/clipboard/clipboard.min.js"></script>
<script src="ENMeval_tutorial_files/libs/quarto-html/quarto.js"></script>
<script src="ENMeval_tutorial_files/libs/quarto-html/popper.min.js"></script>
<script src="ENMeval_tutorial_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ENMeval_tutorial_files/libs/quarto-html/anchor.min.js"></script>
<link href="ENMeval_tutorial_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ENMeval_tutorial_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ENMeval_tutorial_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ENMeval_tutorial_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ENMeval_tutorial_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ENMeval 2.0 tutorial</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jamie M. Kass, Robert Muscarella, Gonzalo E. Pinilla-Buitrago, and Peter J. Galante. Adapted by Thomas J. Smith </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<ul>
<li><a href="#intro">Introduction</a></li>
<li><a href="#data">Data Acquisition &amp; Pre-processing</a></li>
<li><a href="#partition">Partitioning Occurrences for Evaluation</a></li>
<li><a href="#eval">Running ENMeval</a></li>
<li><a href="#select">Model Selection</a></li>
<li><a href="#plot">Plotting results</a></li>
<li><a href="#null">Null Models</a></li>
<li><a href="#metadata">Metadata</a></li>
<li><a href="#resources">References and Resources</a></li>
</ul>
<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Introduction</h2>
<p><a href="https://cran.r-project.org/package=ENMeval"><code>ENMeval</code></a> is an R package that performs automated tuning and evaluations of ecological niche models (ENMs, a.k.a. species distribution models or SDMs), which can estimate species’ ranges and niche characteristics using data on species occurrences and environmental variables (Franklin 2010, Peterson et al.&nbsp;2011, Guisan et al.&nbsp;2017).</p>
<p>Some of the most frequently used ENMs are machine learning algorithms with settings that can be “tuned” to determine optimal levels of model complexity (Hastie et al.&nbsp;2009, Radosavljevic &amp; Anderson 2014, Hallgren et al.&nbsp;2019). In implementation, this means building models of varying settings, then evaluating them and comparing their performance to select the optimal settings. Such tuning exercises can result in models that balance goodness-of-fit (i.e., avoiding overfitting) and predictive ability. Model evaluation is often done with cross-validation, which consists of partitioning the data into groups, building a model with all the groups but one, evaluating this model on the left-out group, then repeating the process until all groups have been left out once (Hastie et al.&nbsp;2009, Roberts et al.&nbsp;2017).</p>
<p><code>ENMeval</code> has one primary function, <code>ENMevaluate()</code>, which runs the tuning analysis and evaluations, returning an <code>ENMevaluation</code> object that contains the results. These results include a table of evaluation statistics, fitted model objects, and prediction rasters for each combination of model settings. The older versions of <code>ENMeval</code> (0.3.0 and earlier; Muscarella et al.&nbsp;2014) implemented only the ENM presence-background algorithm Maxent through the Java software <a href="http://biodiversityinformatics.amnh.org/open_source/maxent/">maxent.jar</a> and the R package <a href="https://cran.r-project.org/package=maxnet"><code>maxnet</code></a>, but <code>ENMeval</code> 2.0 offers functionality for adding and customizing the implementations of ENM algorithms and their evaluations. This new version also features automatic generation of metadata, a null model for calculating effect size and significance of performance metrics, various plotting tools, options for parallel computing, and more.<br>
In this updated vignette, we detail a full ENM analysis: acquisition and processing of input data, sampling background data, deciding on partitioning methods, tuning models, examining results and selecting optimal model settings, building null models to test for significance of performance metrics, and more using <code>ENMeval</code> 2.0 and other relevant R packages. In addition to this vignette, there are other excellent tutorials on ENMs, some of which can be found in the <a href="#resources">References and Resources</a> section.</p>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data Acquisition &amp; Pre-processing</h2>
<p>We’ll start by downloading an occurrence dataset for <a href="https://en.wikipedia.org/wiki/Brown-throated_sloth"><em>Bradypus variegatus</em></a>, the brown-throated sloth. Along the way, if you notice you cannot load a particular package, simply install it with <code>install.packages()</code>, then try <code>library()</code> again.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages -- the order here is important because some pkg functions overwrite others.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ENMeval)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set a random seed in order to be able to reproduce this analysis.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">48</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># You can search online databases like GBIF using the spocc package (commented below),</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># but here we will load in some pre-downloaded data.</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># bv &lt;- spocc::occ('Bradypus variegatus', 'gbif', limit=300, has_coords=TRUE)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># occs &lt;- as.data.frame(bv$gbif$data$Bradypus_variegatus[,2:3])</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>occs <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"bvariegatus.rds"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing occurrences that have the same coordinates is good practice to</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># avoid pseudoreplication.</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>occs <span class="ot">&lt;-</span> occs[<span class="sc">!</span><span class="fu">duplicated</span>(occs),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are going to model the climatic niche suitability for our focal species using climate data from <a href="http://www.worldclim.org/">WorldClim</a>. WorldClim has a range of variables available at various resolutions; for simplicity, here we’ll use the 9 bioclimatic variables at 10 arcmin resolution (about 20 km across at the equator) included in the <code>dismo</code> package from WorldClim 1.4. These climatic data are based on 50-year averages from 1950-2000.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Locate the predictor raster files from the dismo folder.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>envs.files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path=</span><span class="fu">paste</span>(<span class="fu">system.file</span>(<span class="at">package=</span><span class="st">'dismo'</span>), <span class="st">'/ex'</span>, <span class="at">sep=</span><span class="st">''</span>), </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">pattern=</span><span class="st">'grd'</span>, <span class="at">full.names=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the raster files into a RasterStack.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># These variables represent 8 bioclimatic variables and one categorical variable "biome".</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the descriptions of the bioclimatic variables here: </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.worldclim.org/data/bioclim.html</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>envs <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">stack</span>(envs.files)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The biome raster has some NAs for cells that have values in the other rasters.</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's mask all rasters to biome to change the value of these cells to NA for all rasters.</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ENMeval will do this automatically, but let's do it here to avoid the warning message later.</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># We change back from a RasterBrick to RasterStack because of issues with assigning </span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># factor rasters for RasterBricks.</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>envs <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">mask</span>(envs, envs[[<span class="dv">9</span>]]) <span class="sc">%&gt;%</span> raster<span class="sc">::</span><span class="fu">stack</span>()</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure to declare the categorical variable as a factor</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>envs<span class="sc">$</span>biome <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">as.factor</span>(envs<span class="sc">$</span>biome)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's now remove occurrences that are cell duplicates -- these are</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># occurrences that share a grid cell in the predictor variable rasters.</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Although Maxent does this by default, keep in mind that for other algorithms you may</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># or may not want to do this based on the aims of your study.</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Another way to space occurrence records a defined distance from each other to avoid</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co"># spatial autocorrelation is with spatial thinning (Aiello-Lammens et al. 2015).</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>occs.cells <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(envs[[<span class="dv">1</span>]], occs, <span class="at">cellnumbers =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>occs.cellDups <span class="ot">&lt;-</span> <span class="fu">duplicated</span>(occs.cells[,<span class="dv">1</span>])</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>occs <span class="ot">&lt;-</span> occs[<span class="sc">!</span>occs.cellDups,]</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot first raster in the stack, the mean annual temperature.</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(envs[[<span class="dv">1</span>]], <span class="at">main=</span><span class="st">"Mean annual temperature"</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add points for all the occurrence points onto the raster.</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(occs)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co"># There are some points east of the Amazon River.</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose we know this is a population that we don't want to include in the model.</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># We can remove these points from the analysis by subsetting the occurrences by </span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co"># latitude and longitude.</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>occs <span class="ot">&lt;-</span> <span class="fu">filter</span>(occs, latitude <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">20</span>, longitude <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">45</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the subsetted occurrences to make sure we filtered correctly.</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(occs, <span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/envDownload-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now let’s take a look at which areas of this extent are climatically different with respect to the areas associated with the occurrence points. To do this, we’ll use the Multivariate Environmental Similarity surface, or MESS (Elith et al.&nbsp;2010). Higher positive values indicate increasing similarity, while higher negative values indicate dissimilarity. Other methods besides MESS have also been proposed and warrant exploration (e.g., Owens et al.&nbsp;2013, Mesgaran et al.&nbsp;2014). This is important to investigate when considering model transfer to other times or places, as environments that are extremely dissimilar to those used to train the model in the present can result in projections with high uncertainty (Wenger &amp; Olden 2012, Wright et al.&nbsp;2015, Soley-Guardia 2019).</p>
<p>Although the <code>mess()</code> function from the dismo package is frequently used, here we will use tools from the package <a href="https://github.com/johnbaums/rmaxent"><code>rmaxent</code></a> (Baumgartner &amp; Wilson 2021) because it also plots maps of the most similar and dissimilar variables – this functionality is currently included in <code>ENMeval</code> in the <code>similarity()</code> function. We will demonstrate the <code>ENMeval</code> plotting functions for environmental similarity later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we extract the climatic variable values at the occurrence points -- these values are </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># our "reference".</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We remove the categorical variable for these operations because the math only makes sense </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for continuous variables -- the function will not work with categorical variables.</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>occs.z <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(envs[[<span class="sc">-</span><span class="dv">9</span>]], occs)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we use the similarity() function (borrowed from the rmaxent package) to calculate </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># environmental similarity metrics of our predictor variable extent compared to the reference</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># points.</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>occs.sim <span class="ot">&lt;-</span> <span class="fu">similarity</span>(envs[[<span class="sc">-</span><span class="dv">9</span>]], occs.z)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>occs.mess <span class="ot">&lt;-</span> occs.sim<span class="sc">$</span>similarity_min</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the MESS plot -- increasingly negative values represent increasingly different </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># climatic conditions from the reference (our occurrences), while increasingly positive </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># values are more similar. First, we'll make a SpatialPoints object for our occurrences </span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># for plotting with levelplot() from the rasterVis package (Lamigueiro &amp; Hijmans 2021).</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># This package has great plotting functionality for rasters, and by default bins values for </span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># display when data is continuous.</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>occs.sp <span class="ot">&lt;-</span> sp<span class="sc">::</span><span class="fu">SpatialPoints</span>(occs)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Vector data (points, polygons) are added to a levelplot with a "+", like ggplot.</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>rasterVis<span class="sc">::</span><span class="fu">levelplot</span>(occs.mess, <span class="at">main =</span> <span class="st">"Environmental similarity"</span>, <span class="at">margin =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">sp.points</span>(occs.sp, <span class="at">col=</span><span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuous plotting can be done as demonstrated below by specifiying a scale</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>myScale <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">cellStats</span>(occs.mess, min), <span class="fu">cellStats</span>(occs.mess, max), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>rasterVis<span class="sc">::</span><span class="fu">levelplot</span>(occs.mess, <span class="at">main =</span> <span class="st">"Environmental similarity"</span>, <span class="at">at =</span> myScale, <span class="at">margin =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">sp.points</span>(occs.sp, <span class="at">col=</span><span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we define some good colors for representing categorical variables</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Set1"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This map shows the variable for each grid cell that is most different from the reference</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>rasterVis<span class="sc">::</span><span class="fu">levelplot</span>(occs.sim<span class="sc">$</span>mod, <span class="at">col.regions =</span> cols, <span class="at">main =</span> <span class="st">"Most different variable"</span>) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">sp.points</span>(occs.sp, <span class="at">col=</span><span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This map shows the variable for each grid cell that is most similar to the reference</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>rasterVis<span class="sc">::</span><span class="fu">levelplot</span>(occs.sim<span class="sc">$</span>mos, <span class="at">col.regions =</span> cols, <span class="at">main =</span> <span class="st">"Most similar variable"</span>) <span class="sc">+</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  latticeExtra<span class="sc">::</span><span class="fu">layer</span>(<span class="fu">sp.points</span>(occs.sp, <span class="at">col=</span><span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Since our models will compare the environment at occurrence localities to the environment at background localities, we need to sample random points from a background extent. Now we will specify the study extent that defines where we sample background data by cropping our global predictor variable rasters to a smaller region. To help ensure we do not include areas that are suitable for our species but are unoccupied due to limitations like dispersal constraints, we will conservatively define the background extent as an area surrounding our occurrence localities (VanDerWal et al.&nbsp;2009, Merow et al.&nbsp;2013). We will do this by buffering a bounding box that includes all occurrence localities. Some other methods of background extent delineation (e.g., minimum convex hulls) are more conservative because they better characterize the geographic space holding the points. In any case, this is one of the many things that you will need to carefully consider for your own study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll now experiment with a different spatial R package called sf (simple features).</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's make our occs into a sf object -- as the coordinate reference system (crs) for these </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># points is WGS84, a geographic crs (lat/lon) and the same as our envs rasters, we specify it </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># as the RasterStack's crs.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>occs.sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(occs, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>,<span class="st">"latitude"</span>), <span class="at">crs =</span> raster<span class="sc">::</span><span class="fu">crs</span>(envs))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, we project our point data to an equal-area projection, which converts our </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># degrees to meters, which is ideal for buffering (the next step). </span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># We use the typical Eckert IV projection.</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>eckertIV <span class="ot">&lt;-</span> <span class="st">"+proj=eck4 +lon_0=0 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs"</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>occs.sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(occs.sf, <span class="at">crs =</span> eckertIV)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Buffer all occurrences by 500 km, union the polygons together </span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># (for visualization), and convert back to a form that the raster package </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># can use. Finally, we reproject the buffers back to WGS84 (lat/lon).</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># We choose 500 km here to avoid sampling the Caribbean islands.</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>occs.buf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_buffer</span>(occs.sf, <span class="at">dist =</span> <span class="dv">500000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_union</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_sf</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="at">crs =</span> raster<span class="sc">::</span><span class="fu">crs</span>(envs))</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(envs[[<span class="dv">1</span>]], <span class="at">main =</span> <span class="fu">names</span>(envs)[<span class="dv">1</span>])</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(occs)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># To add sf objects to a plot, use add = TRUE</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(occs.buf, <span class="at">border =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/backgExt-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Crop environmental rasters to match the study extent</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>envs.bg <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">crop</span>(envs, occs.buf)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Next, mask the rasters to the shape of the buffers</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>envs.bg <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">mask</span>(envs.bg, occs.buf)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(envs.bg[[<span class="dv">1</span>]], <span class="at">main =</span> <span class="fu">names</span>(envs)[<span class="dv">1</span>])</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(occs)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(occs.buf, <span class="at">border =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/backgExt-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the next step, we’ll sample 10,000 random points from the background (note that the number of background points is also a consideration you should make with respect to your own study).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly sample 10,000 background points from one background extent raster </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (only one per cell without replacement). Note: Since the raster has &lt;10,000 pixels, </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># you'll get a warning and all pixels will be used for background. We will be sampling </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># from the biome variable because it is missing some grid cells, and we are trying to </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># avoid getting background points with NA. If one raster in the stack has NAs where the</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># other rasters have data, ENMeval internally converts these cells to NA.</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>bg <span class="ot">&lt;-</span> dismo<span class="sc">::</span><span class="fu">randomPoints</span>(envs.bg[[<span class="dv">9</span>]], <span class="at">n =</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bg) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(occs)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice how we have pretty good coverage (every cell).</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(envs.bg[[<span class="dv">1</span>]])</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(bg, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/backgPts-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="partition" class="level2">
<h2 class="anchored" data-anchor-id="partition">Partitioning Occurrences for Evaluation</h2>
<p>A run of <code>ENMevaluate()</code> begins by using one of seven methods to partition occurrence localities into validation and training bins (folds) for <em>k</em>-fold cross-validation (Fielding &amp; Bell 1997, Hastie et al.&nbsp;2009, Peterson et al.&nbsp;2011). Data partitioning is done internally by <code>ENMevaluate()</code> based on what the user inputs for the <code>partitions</code> argument, but this can also be done externally using the partitioning functions. In this section, we explain and illustrate these different functions. We also demonstrate how to make informative plots of partitions and the environmental similarity of partitions to the background or study extent.</p>
<ol type="1">
<li><a href="#block">Spatial Block</a></li>
<li><a href="#cb1">Spatial Checkerboard</a></li>
<li><a href="#cb2">Spatial Hierarchical Checkerboard</a></li>
<li><a href="#jack">Jackknife (leave-one-out)</a></li>
<li><a href="#rand">Random <em>k</em>-fold</a></li>
<li><a href="#testing">Fully Withheld Testing Data</a></li>
<li><a href="#user">User</a></li>
</ol>
<p>The first three partitioning methods are variations of what Radosavljevic and Anderson (2014) referred to as ‘masked geographically structured’ data partitioning. Basically, these methods partition both occurrence and background records into evaluation bins based on spatial rules. The intention is to reduce spatial-autocorrelation between points that are included in the validation and training bins, which can overinflate model performance, at least for data sets that result from biased sampling (Veloz 2009, Wenger &amp; Olden 2012, Roberts et al.&nbsp;2017). Other spatial partitioning methods for ENMs can be found in the R package <code>blockCV</code> (Valavi et al.&nbsp;2019), which we demonstrate below for use with <code>ENMeval</code>.</p>
<section id="block" class="level4">
<h4 class="anchored" data-anchor-id="block">1. Block</h4>
<p>First, the ‘block’ method partitions data according to the latitude and longitude lines that divide the occurrence localities into four spatial groups of equal numbers (or as close as possible). Both occurrence and background localities are assigned to each of the four bins based on their position with respect to these lines – the first direction bisects the points into two groups, and the second direction bisects each of these further into two groups each, resulting in four groups. The resulting object is a list of two vectors that supply the bin designation for each occurrence and background point. In <code>ENMeval</code> 2.0, users can additionally specify different orientations for the blocking with the <code>orientation</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>block <span class="ot">&lt;-</span> <span class="fu">get.block</span>(occs, bg, <span class="at">orientation =</span> <span class="st">"lat_lon"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's make sure that we have an even number of occurrences in each partition.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(block<span class="sc">$</span>occs.grp)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1  2  3  4 </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 22 21 22 21</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We can plot our partitions on one of our predictor variable rasters to visualize </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># where they fall in space.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># The ENMeval 2.0 plotting functions use ggplot2 (Wickham 2016), a popular plotting </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># package for R with many online resources.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># We can add to the ggplots with other ggplot functions in an additive way, making </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># these plots easily customizable.</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> occs, <span class="at">pts.grp =</span> block<span class="sc">$</span>occs.grp, <span class="at">envs =</span> envs.bg) <span class="sc">+</span> </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">"Spatial block partitions: occurrences"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.block-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PLotting the background shows that the background extent is partitioned in a way </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># that maximizes evenness of points across the four bins, not to maximize evenness of area.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> bg, <span class="at">pts.grp =</span> block<span class="sc">$</span>bg.grp, <span class="at">envs =</span> envs.bg) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggtitle</span>(<span class="st">"Spatial block partitions: background"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.block-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># If we are curious how different the environment associated with each partition is from </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># that of all the others, we can use this function to plot histograms or rasters of MESS </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions with each partition as the reference.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># First we need to extract the predictor variable values at our occurrence and </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># background localities.</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>occs.z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(occs, raster<span class="sc">::</span><span class="fu">extract</span>(envs, occs))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>bg.z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(bg, raster<span class="sc">::</span><span class="fu">extract</span>(envs, bg))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.hist</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">occs.z =</span> occs.z, <span class="at">bg.z =</span> bg.z, </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">occs.grp =</span> block<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> block<span class="sc">$</span>bg.grp, <span class="at">categoricals =</span> <span class="st">"biome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.block-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.hist</span>(<span class="at">sim.type =</span> <span class="st">"most_diff"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">occs.z =</span> occs.z, <span class="at">bg.z =</span> bg.z, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">occs.grp =</span> block<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> block<span class="sc">$</span>bg.grp, <span class="at">categoricals =</span> <span class="st">"biome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.block-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.hist</span>(<span class="at">sim.type =</span> <span class="st">"most_sim"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">occs.z =</span> occs.z, <span class="at">bg.z =</span> bg.z, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">occs.grp =</span> block<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> block<span class="sc">$</span>bg.grp, <span class="at">categoricals =</span> <span class="st">"biome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.block-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we plot environmental similarity values for the entire extent with respect </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># to each validation group.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We use the bb.buf (bounding box buffer) argument to zoom in to our study extent.</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.map</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">envs =</span> envs, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> block<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> block<span class="sc">$</span>bg.grp, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categoricals =</span> <span class="st">"biome"</span>, <span class="at">bb.buf =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.block-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.map</span>(<span class="at">sim.type =</span> <span class="st">"most_diff"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">envs =</span> envs, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> block<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> block<span class="sc">$</span>bg.grp, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categoricals =</span> <span class="st">"biome"</span>, <span class="at">bb.buf =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.block-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.map</span>(<span class="at">sim.type =</span> <span class="st">"most_sim"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">envs =</span> envs, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> block<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> block<span class="sc">$</span>bg.grp, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categoricals =</span> <span class="st">"biome"</span>, <span class="at">bb.buf =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.block-8.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cb1" class="level4">
<h4 class="anchored" data-anchor-id="cb1">2. Checkerboard1</h4>
<p>The next two partitioning methods are variants of a ‘checkerboard’ approach to partition occurrence localities (Radosavljevic &amp; Anderson 2014). These generate checkerboard grids across the study extent and partition the localities into groups based on where they fall on the checkerboard. In contrast to the block method, both checkerboard methods subdivide geographic space equally but do not ensure a balanced number of occurrence localities in each bin. For these methods, the user needs to provide a raster layer on which to base the underlying checkerboard pattern. Here we simply use the predictor variable RasterStack. Additionally, the user needs to define an <em>aggregation.factor</em>. This value specifies the number of grids cells to aggregate when making the underlying checkerboard pattern.</p>
<p>The checkerboard1 method partitions the points into <em>k</em> = 2 spatial groups using a simple checkerboard pattern.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cb1 <span class="ot">&lt;-</span> <span class="fu">get.checkerboard1</span>(occs, envs.bg, bg, <span class="at">aggregation.factor=</span><span class="dv">5</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> occs, <span class="at">pts.grp =</span> cb1<span class="sc">$</span>occs.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the background points shows the checkerboard pattern clearly.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> bg, <span class="at">pts.grp =</span> cb1<span class="sc">$</span>bg.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can see from the MESS maps that this method results in similar environmental </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># representation between the partitions.</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.hist</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">occs.z =</span> occs.z, <span class="at">bg.z =</span> bg.z, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">occs.grp =</span> cb1<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> cb1<span class="sc">$</span>bg.grp, <span class="at">categoricals =</span> <span class="st">"biome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck1-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.map</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">envs =</span> envs, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> cb1<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> cb1<span class="sc">$</span>bg.grp, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categoricals =</span> <span class="st">"biome"</span>, <span class="at">bb.buf =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck1-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can increase the aggregation factor to give the groups bigger boxes.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This can result in groups that are more environmentally different from each other.</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>cb1.large <span class="ot">&lt;-</span> <span class="fu">get.checkerboard1</span>(occs, envs.bg, bg, <span class="at">aggregation.factor=</span><span class="dv">30</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> occs, <span class="at">pts.grp =</span> cb1.large<span class="sc">$</span>occs.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck1-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> bg, <span class="at">pts.grp =</span> cb1.large<span class="sc">$</span>bg.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck1-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.hist</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> cb1.large<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> cb1<span class="sc">$</span>bg.grp, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">categoricals =</span> <span class="st">"biome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck1-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.map</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">envs =</span> envs, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> cb1.large<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> cb1<span class="sc">$</span>bg.grp, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categoricals =</span> <span class="st">"biome"</span>, <span class="at">bb.buf =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck1-8.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cb2" class="level4">
<h4 class="anchored" data-anchor-id="cb2">3. Checkerboard2</h4>
<p>The Checkerboard2 method partitions the data into <em>k</em> = 4 spatial groups. This is done by hierarchically aggregating the input raster at two scales. Presence and background groups are assigned based on which box they fall into on the hierarchical checkerboard.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>cb2 <span class="ot">&lt;-</span> <span class="fu">get.checkerboard2</span>(occs, envs.bg, bg, <span class="at">aggregation.factor=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> occs, <span class="at">pts.grp =</span> cb2<span class="sc">$</span>occs.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the background points shows the checkerboard pattern very clearly.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> bg, <span class="at">pts.grp =</span> cb2<span class="sc">$</span>bg.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Different from checkerboard1, some partitions here do show some difference</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in environmental representation, but not as consistently different as with block.</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.hist</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> cb2<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> cb2<span class="sc">$</span>bg.grp, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">categoricals =</span> <span class="st">"biome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.map</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">envs =</span> envs, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> cb2<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> cb2<span class="sc">$</span>bg.grp, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categoricals =</span> <span class="st">"biome"</span>, <span class="at">bb.buf =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ck2-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="jack" class="level4">
<h4 class="anchored" data-anchor-id="jack">4. Jackknife (leave-one-out)</h4>
<p>The next two methods differ from the first three in that (a) they do not partition the background points into different groups (meaning that the full background is used to evaluate each partition), and (b) they do not account for spatial autocorrelation between validation and training localities. Primarily when working with relatively small data sets (e.g.&nbsp;&lt; ca. 25 presence localities), users may choose a special case of <em>k</em>-fold cross-validation where the number of bins (<em>k</em>) is equal to the number of occurrence localities (<em>n</em>) in the data set (Pearson et al.&nbsp;2007; Shcheglovitova &amp; Anderson 2013). This is referred to as jackknife, or leave-one-out, partitioning (Hastie et al.&nbsp;2009). As <em>n</em> models are processed with this partitioning method, the computation time could be long for large occurrence datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>jack <span class="ot">&lt;-</span> <span class="fu">get.jackknife</span>(occs, bg)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># If the number of input points is larger than 10, the legend for the groups </span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># is suppressed.</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> occs, <span class="at">pts.grp =</span> jack<span class="sc">$</span>occs.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.jk-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="rand" class="level4">
<h4 class="anchored" data-anchor-id="rand">5. Random k-fold</h4>
<p>The ‘random k-fold’ method partitions occurrence localities randomly into a user-specified number of (<em>k</em>) bins (Hastie et al.&nbsp;2009). This method is equivalent to the ‘cross-validate’ partitioning scheme available in the current version of the Maxent software GUI. Especially with larger occurrence datasets, this partitioning method could randomly result in some spatial clustering of groups, which is why spatial partitioning methods are preferable for addressing spatial autocorrelation (Roberts et al.&nbsp;2017). Below, we partition the data into five random groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>rand <span class="ot">&lt;-</span> <span class="fu">get.randomkfold</span>(occs, bg, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> occs, <span class="at">pts.grp =</span> rand<span class="sc">$</span>occs.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.rand-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># As the partitions are random, there is no large environmental difference between them.</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.hist</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> rand<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> rand<span class="sc">$</span>bg.grp, </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">categoricals =</span> <span class="st">"biome"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.rand-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.map</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">envs =</span> envs, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> rand<span class="sc">$</span>occs.grp, <span class="at">bg.grp =</span> rand<span class="sc">$</span>bg.grp, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categoricals =</span> <span class="st">"biome"</span>, <span class="at">bb.buf =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.rand-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="testing" class="level4">
<h4 class="anchored" data-anchor-id="testing">6. Fully Withheld Testing Data</h4>
<p>The ‘testing’ method evaluates the model on a fully withheld testing dataset that is not used to create the full model (i.e., not included in the training data), meaning that cross validation statistics are not calculated. Evaluations with fully withheld testing data have been shown to result in models with better transferability (Soley-Guardia et al.&nbsp;2019).</p>
<p>To illustrate this, we will make a table containing occurrences representing both training data and fully withheld testing data (which we simulate) and plot the partitions in the same way as above. However, the testing data (group 2) will not become training data for a new model. Instead, the training data (group 1) is used to make the model, and the testing data (group 2) are used only to evaluate it. Thus, the background extent does not include the testing data (a few points fall inside this extent because of the buffer we applied, but they are not used as training data).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let's specify a fake testing occurrence dataset and plot the testing points with </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the rest of our data</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>occs.testing <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">longitude =</span> <span class="sc">-</span><span class="fu">runif</span>(<span class="dv">10</span>, <span class="dv">55</span>, <span class="dv">65</span>), <span class="at">latitude =</span> <span class="fu">runif</span>(<span class="dv">10</span>, <span class="sc">-</span><span class="dv">10</span>, <span class="dv">0</span>))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> <span class="fu">rbind</span>(occs, occs.testing), </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">pts.grp =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(occs)), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(occs.testing))), <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ind-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Next, let's extract the predictor variable values for our testing points.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>occs.testing.z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(occs.testing, raster<span class="sc">::</span><span class="fu">extract</span>(envs, occs.testing))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We use the same background groups as random partitions here because the background used </span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for testing data is also from the full study extent. We use here the occs.testing.z </span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># parameter to add information for our testing localities, and we set the partitions </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for occurrences all to zero (as no partitioning is done).</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.hist</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(occs)), <span class="at">bg.grp =</span> rand<span class="sc">$</span>bg.grp, </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">categoricals =</span> <span class="st">"biome"</span>, <span class="at">occs.testing.z =</span> occs.testing.z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ind-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.envSim.map</span>(<span class="at">sim.type =</span> <span class="st">"mess"</span>, <span class="at">ref.data =</span> <span class="st">"occs"</span>, <span class="at">envs =</span> envs, <span class="at">occs.z =</span> occs.z, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bg.z =</span> bg.z, <span class="at">occs.grp =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(occs)), <span class="at">bg.grp =</span> rand<span class="sc">$</span>bg.grp, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">categoricals =</span> <span class="st">"biome"</span>, <span class="at">bb.buf =</span> <span class="dv">7</span>, <span class="at">occs.testing.z =</span> occs.testing.z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.ind-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can see what is to be expected -- the testing dataset is much more restricted </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># environmentally than the training data, and thus is much more difference with the </span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># study extent.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="user" class="level4">
<h4 class="anchored" data-anchor-id="user">7. User-defined</h4>
<p>For maximum flexibility, the last partitioning method is designed so that users can define <em>a priori</em> partitions. This provides a flexible way to conduct spatially-independent cross-validation with background masking. For example, we demonstrate partitioning the occurrence data based on <em>k</em>-means groups. The user-defined partition option can also be used to input partition groups derived from other sources.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we run a k-means clustering algorithm to group our occurrences into discrete spatial </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># groups based on their coordinates.</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>grp.n <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>kmeans <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(occs, grp.n)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>occs.grp <span class="ot">&lt;-</span> kmeans<span class="sc">$</span>cluster</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> occs, <span class="at">pts.grp =</span> occs.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.user1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When using the user-defined partitioning method, we need to supply <code>ENMevaluate()</code> with group identifiers for both occurrence AND background records If we want to use all background records for each group, we can set the background to zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign all background records</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>bg.grp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(bg))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> bg, <span class="at">pts.grp =</span> bg.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.user2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Alternatively, we may think of various ways to partition background data. This depends on the goals of the study but we might, for example, find it reasonable to partition background records by assigning groups based on distance to the centroids of the occurrence clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we find the centers of the occurrence k-means clusters and calculate the spatial </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># distance of each background point to them. We then find which center had the minimum </span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># distance for each record and assign that record to this centroid group.</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>centers <span class="ot">&lt;-</span> kmeans<span class="sc">$</span>center</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">pointDistance</span>(bg, centers, <span class="at">lonlat =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>bg.grp <span class="ot">&lt;-</span> <span class="fu">apply</span>(d, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">which</span>(x <span class="sc">==</span> <span class="fu">min</span>(x)))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> bg, <span class="at">pts.grp =</span> bg.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/part.user3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also use other packages to partition our data. As an example, we next show how to use the R package <a href="https://CRAN.R-project.org/package=blockCV"><code>blockCV</code></a> (Valavi et al.&nbsp;2019) to generate spatial partitions to input into <code>ENMevaluate()</code>. We use the <code>spatialBlock()</code> function to generate blocks similar to the checkerboard partition in <code>ENMeval</code>, except that we choose here to select partitions randomly over these blocks. This package offers other kinds of block partitioning methods as well. Using other packages in this way expands the variety of partitions you can use to evaluate models in <code>ENMeval</code>, and we highly encourage experimenting with a plurality of tools.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(blockCV)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we convert our occurrence and background records to spatial point data with the </span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># package sf and assign the correct coordinate reference system.</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>occsBg.sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">rbind</span>(occs, bg), <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>,<span class="st">"latitude"</span>), </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">crs =</span> <span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>raster<span class="sc">::</span><span class="fu">crs</span>(envs.bg) <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">crs</span>(occsBg.sf)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, we implement the spatialBlock function from the blockCV package.</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The required inputs are similar to ENMeval partitioning functions, but here you assign</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># the size of blocks in meters with the argument theRange (here set at 1000 km), and the </span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># partition selection method can be assigned as either "checkerboard" or "random"</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># In addition, the spatialBlock function returns a map showing the different </span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># spatial partitions.</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>sb <span class="ot">&lt;-</span> blockCV<span class="sc">::</span><span class="fu">spatialBlock</span>(<span class="at">speciesData =</span> occsBg.sf, <span class="at">rasterLayer =</span> envs.bg, </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">theRange =</span> <span class="dv">1000000</span>, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">selection =</span> <span class="st">"random"</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The best folds was in iteration 52:</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   train test</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2262  496</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2166  592</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2161  597</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2261  497</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2182  576</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can pull out the partition information from the SpatialBlock object to assemble</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># occs.grp and bg.grp, which can be used for plotting or as user.grp inputs for ENMevaluate.</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>occs.grp <span class="ot">&lt;-</span> sb<span class="sc">$</span>foldID[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(occs)]</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>bg.grp <span class="ot">&lt;-</span> sb<span class="sc">$</span>foldID[(<span class="fu">nrow</span>(occs)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(sb<span class="sc">$</span>foldID)]</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.grps</span>(<span class="at">pts =</span> bg, <span class="at">pts.grp =</span> bg.grp, <span class="at">envs =</span> envs.bg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Selecting which of these data partitioning methods to use should be based on the research objectives and the characteristics of the study system. Refer to the <a href="#resources">References and Resources</a> section for studies and resources to consult for more information concerning partitioning for model evaluation.</p>
</section>
</section>
<section id="eval" class="level2">
<h2 class="anchored" data-anchor-id="eval">Running ENMeval</h2>
<p>Once we decide which method of data partitioning we would like to use, we are ready to start building models. We now move on to the main function in <code>ENMeval</code>: <code>ENMevaluate()</code>.</p>
<section id="initial-considerations" class="level4">
<h4 class="anchored" data-anchor-id="initial-considerations">Initial considerations</h4>
<p>Although any algorithm can potentially be specified in ENMeval 2.0 (see below), and <code>ENMeval</code> 2.0 has built-in implementations for Maxent and BIOCLIM, we will explain here the tuning procedure for Maxent models (either <code>maxent.jar</code> or <code>maxnet</code>). For Maxent models (Phillips et al.&nbsp;2006, Phillips et al.&nbsp;2008, Phillips et al.&nbsp;2017), the two main parameters to tune when calling <code>ENMevaluate</code> are (1) the range of regularization multiplier values and (2) the combinations of feature classes (Elith et al.&nbsp;2011, Merow et al.&nbsp;2013). The <strong><em>regularization multiplier</em></strong> (RM) determines the penalty associated with including variables or their transformations in the model. Higher RM values impose a stronger penalty on model complexity and thus result in simpler (<em>flatter</em>) model predictions. The <strong><em>feature classes</em></strong> determine the potential shape of the marginal response curves. A model that is only allowed to include linear feature classes will most likely be simpler than a model that is allowed to include all possible feature classes. A more detailed description of these parameters is available in the <a href="#resources">References and Resources</a> section. For the purposes of this vignette, we demonstrate simply how to adjust these parameters. The following section deals with comparing the outputs of each model.</p>
<p>Unless you supply the function with background points (which is recommended in many cases), you will need to define how many background points should be used with the <code>n.bg</code> argument. If any of your predictor variables are categorical (e.g., biomes in this dataset), you should define which layer(s) these are using the ‘categoricals’ argument or assign them as factors in the RasterStack or input table (like we did here).</p>
<p><code>ENMevaluate()</code> builds a separate model for each unique combination of RM values and feature class combinations. For example, the following call will build and evaluate 2 models. One with RM=1 and another with RM=2, both allowing only linear features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>e.mx.l <span class="ot">&lt;-</span> <span class="fu">ENMevaluate</span>(<span class="at">occs =</span> occs, <span class="at">envs =</span> envs, <span class="at">bg =</span> bg, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">algorithm =</span> <span class="st">'maxnet'</span>, <span class="at">partitions =</span> <span class="st">'block'</span>, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tune.args =</span> <span class="fu">list</span>(<span class="at">fc =</span> <span class="st">"L"</span>, <span class="at">rm =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>e.mx.l</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class:  ENMevaluation </span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  occurrence/background points:  86 / 2672 </span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  partition method:  block </span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  partition settings:  orientation = lat_lon </span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  clamp:  left: bio1, bio12, bio16, bio17, bio5, bio6, bio7, bio8, biome</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          right: bio1, bio12, bio16, bio17, bio5, bio6, bio7, bio8, biome </span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  categoricals:  biome </span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  algorithm:  maxnet </span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  tune settings:  fc: L</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  rm: 1,2 </span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  overlap:  TRUE </span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Refer to ?ENMevaluation for information on slots.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We may, however, want to compare a wider range of models that can use a wider variety of feature classes and regularization multipliers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>e.mx <span class="ot">&lt;-</span> <span class="fu">ENMevaluate</span>(<span class="at">occs =</span> occs, <span class="at">envs =</span> envs, <span class="at">bg =</span> bg, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">algorithm =</span> <span class="st">'maxnet'</span>, <span class="at">partitions =</span> <span class="st">'block'</span>, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tune.args =</span> <span class="fu">list</span>(<span class="at">fc =</span> <span class="fu">c</span>(<span class="st">"L"</span>,<span class="st">"LQ"</span>,<span class="st">"LQH"</span>,<span class="st">"H"</span>), <span class="at">rm =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>e.mx</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class:  ENMevaluation </span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  occurrence/background points:  86 / 2672 </span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  partition method:  block </span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  partition settings:  orientation = lat_lon </span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  clamp:  left: bio1, bio12, bio16, bio17, bio5, bio6, bio7, bio8, biome</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          right: bio1, bio12, bio16, bio17, bio5, bio6, bio7, bio8, biome </span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  categoricals:  biome </span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  algorithm:  maxnet </span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  tune settings:  fc: L,LQ,LQH,H</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  rm: 1,2,3,4,5 </span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  overlap:  TRUE </span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Refer to ?ENMevaluation for information on slots.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When building many models, the function may take a long time to run. Of course this depends on the size of your dataset and the computer you are using. When working on big projects, running the command in parallel (<code>parallel=TRUE</code>) can be considerably faster. Note that running parallel can also be slower when working on small datasets.</p>
<p>We can also calculate one of two niche overlap statistics while running <code>ENMevaluate</code> by setting the arguments <code>overlap=TRUE</code> and <code>overlapStat</code>, which support Moran’s I or Schoener’s D (Warren et al.&nbsp;2008). Note that you can also calculate this value at a later stage using the separate <code>calc.niche.overlap()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>overlap <span class="ot">&lt;-</span> <span class="fu">calc.niche.overlap</span>(e.mx<span class="sc">@</span>predictions, <span class="at">overlapStat =</span> <span class="st">"D"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>overlap[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             fc.L_rm.1 fc.LQ_rm.1 fc.LQH_rm.1 fc.H_rm.1 fc.L_rm.2 fc.LQ_rm.2</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.L_rm.1          NA         NA          NA        NA        NA         NA</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.LQ_rm.1  0.9048423         NA          NA        NA        NA         NA</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.LQH_rm.1 0.8305069  0.8655913          NA        NA        NA         NA</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.H_rm.1   0.8197267  0.8437473   0.9536294        NA        NA         NA</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.L_rm.2   0.9479398  0.8756846   0.8134494  0.809888        NA         NA</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             fc.LQH_rm.2 fc.H_rm.2 fc.L_rm.3 fc.LQ_rm.3 fc.LQH_rm.3 fc.H_rm.3</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.L_rm.1            NA        NA        NA         NA          NA        NA</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.LQ_rm.1           NA        NA        NA         NA          NA        NA</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.LQH_rm.1          NA        NA        NA         NA          NA        NA</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.H_rm.1            NA        NA        NA         NA          NA        NA</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.L_rm.2            NA        NA        NA         NA          NA        NA</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             fc.L_rm.4 fc.LQ_rm.4 fc.LQH_rm.4 fc.H_rm.4 fc.L_rm.5 fc.LQ_rm.5</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.L_rm.1          NA         NA          NA        NA        NA         NA</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.LQ_rm.1         NA         NA          NA        NA        NA         NA</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.LQH_rm.1        NA         NA          NA        NA        NA         NA</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.H_rm.1          NA         NA          NA        NA        NA         NA</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.L_rm.2          NA         NA          NA        NA        NA         NA</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             fc.LQH_rm.5 fc.H_rm.5</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.L_rm.1            NA        NA</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.LQ_rm.1           NA        NA</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.LQH_rm.1          NA        NA</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.H_rm.1            NA        NA</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; fc.L_rm.2            NA        NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="different-parameterizations" class="level4">
<h4 class="anchored" data-anchor-id="different-parameterizations">Different parameterizations</h4>
<p>There are multiple ways to run the function <code>ENMevaluate()</code>, and we will go over how to specify each parameterization and what the effects are on the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If maxent.jar is installed and rJava loads properly, you can also run Maxent with </span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the original Java software.</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>tune.args <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">fc =</span> <span class="fu">c</span>(<span class="st">"L"</span>, <span class="st">"LQ"</span>), <span class="at">rm =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>e.mxjar <span class="ot">&lt;-</span> <span class="fu">ENMevaluate</span>(occs, envs, bg, <span class="at">algorithm =</span> <span class="st">"maxent.jar"</span>, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tune.args =</span> tune.args, <span class="at">partitions =</span> <span class="st">"block"</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Testing partition: no cross validation statistics calculated; instead, model will be </span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluated on a testing dataset that is not used to create the full model.</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>e.test <span class="ot">&lt;-</span> <span class="fu">ENMevaluate</span>(occs, envs, bg, <span class="at">algorithm =</span> <span class="st">"maxnet"</span>, </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tune.args =</span> tune.args, <span class="at">partitions =</span> <span class="st">"testing"</span>, </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">occs.testing =</span> occs.testing)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. User partitions.</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>user.grp <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">occs.grp =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="fu">nrow</span>(occs), <span class="dv">1</span>, <span class="dv">2</span>)), </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bg.grp =</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="fu">nrow</span>(bg), <span class="dv">1</span>, <span class="dv">2</span>)))</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>e.user <span class="ot">&lt;-</span> <span class="fu">ENMevaluate</span>(occs, envs, bg, <span class="at">algorithm =</span> <span class="st">"maxnet"</span>, </span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tune.args =</span> tune.args, <span class="at">partitions =</span> <span class="st">"user"</span>, <span class="at">user.grp =</span> user.grp)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. No partitions: no cross validation statistics calculated, nor any model </span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluation on test data.</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>e.noCV <span class="ot">&lt;-</span> <span class="fu">ENMevaluate</span>(occs, envs, bg, <span class="at">algorithm =</span> <span class="st">"maxnet"</span>, </span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tune.args =</span> tune.args, <span class="at">partitions =</span> <span class="st">"none"</span>)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. No raster data (a.k.a, samples with data, or SWD): no full model raster predictions </span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="co"># created, so will run faster; also, both cbi.train and cbi.val will be calculated on the </span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="co"># point data (training and validation background) instead of on the "envs" rasters (default).</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="co"># For this implementation, assigning the categorical variable to factor with the argument </span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="co"># "categoricals" is easier, as ENMevaluate() internally assigns the levels based on both </span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="co"># occs and bg, avoiding any errors associated with different factor levels when combining data.</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>occs.z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(occs, raster<span class="sc">::</span><span class="fu">extract</span>(envs, occs))</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>bg.z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(bg, raster<span class="sc">::</span><span class="fu">extract</span>(envs, bg))</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>e.swd <span class="ot">&lt;-</span> <span class="fu">ENMevaluate</span>(occs.z, <span class="at">bg =</span> bg.z, <span class="at">algorithm =</span> <span class="st">"maxnet"</span>, <span class="at">tune.args =</span> tune.args, </span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">partitions =</span> <span class="st">"block"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can also specify your own custom validation statistics for <code>ENMevaluate()</code> to calculate and report in the results tables. This is done by defining a custom function that has the arguments shown below, which are used by the internal function <code>tune.validate()</code>. Here, we add functionality to calculate the AUC ratio and associated p-value for the partial ROC perfomance metric, defined in (Peterson et al.&nbsp;2008) and implemented by the R package <code>kuenm</code> (Cobos et al.&nbsp;2019), which is currently only available on Github.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, make sure you install kuenm from Github.</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"marlonecobos/kuenm"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a custom function that implements a performance metric not included in ENMeval.</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The function should have a single argument "vars", which is a list that includes the </span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># data most performance metrics should require -- the total list of these data can be found </span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># here: ?ENMevaluate. Make sure you return a data frame that specifies the names you want to </span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># see in the results tables.</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>proc <span class="ot">&lt;-</span> <span class="cf">function</span>(vars) {</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  proc <span class="ot">&lt;-</span> kuenm<span class="sc">::</span><span class="fu">kuenm_proc</span>(vars<span class="sc">$</span>occs.val.pred, <span class="fu">c</span>(vars<span class="sc">$</span>bg.train.pred, vars<span class="sc">$</span>bg.val.pred))</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">proc_auc_ratio =</span> proc<span class="sc">$</span>pROC_summary[<span class="dv">1</span>], </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">proc_pval =</span> proc<span class="sc">$</span>pROC_summary[<span class="dv">2</span>], <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can run ENMevaluate() with the argument "user.eval", and simply give it the </span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="co"># custom function.</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>e.mx.proc <span class="ot">&lt;-</span> <span class="fu">ENMevaluate</span>(occs, envs, bg, <span class="at">algorithm =</span> <span class="st">"maxnet"</span>, </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">tune.args =</span> <span class="fu">list</span>(<span class="at">fc =</span> <span class="st">"L"</span>, <span class="at">rm =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), </span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>                         <span class="at">partitions =</span> <span class="st">"block"</span>, <span class="at">user.eval =</span> proc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can see the new performance statistic averages in the results and </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># results.partitions tables.</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>e.mx.proc<span class="sc">@</span>results</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   fc rm tune.args auc.train cbi.train auc.diff.avg auc.diff.sd auc.val.avg</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  L  1 fc.L_rm.1 0.8745683     0.926   0.07986244  0.04406351   0.8591106</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  L  2 fc.L_rm.2 0.8744404     0.934   0.08009704  0.04090725   0.8603552</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   auc.val.sd cbi.val.avg cbi.val.sd or.10p.avg or.10p.sd or.mtp.avg or.mtp.sd</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.07327265      0.7775  0.1260410  0.1517210 0.1611428 0.10869565 0.1304348</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.07288020      0.7510  0.1711568  0.1734601 0.1980550 0.09782609 0.1143459</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   proc_auc_ratio.avg proc_auc_ratio.sd proc_pval.avg proc_pval.sd     AICc</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1           2.213807         0.1497749             0            0 1579.307</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2           2.192230         0.1330264             0            0 1571.192</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   delta.AICc     w.AIC ncoef</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    8.11448 0.0170026     6</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    0.00000 0.9829974     6</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>e.mx.proc<span class="sc">@</span>results.partitions</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   tune.args fold   auc.val   auc.diff cbi.val    or.mtp     or.10p</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 fc.L_rm.1    1 0.8888176 0.02294783   0.786 0.0000000 0.04166667</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 fc.L_rm.1    2 0.8178372 0.06896667   0.672 0.1739130 0.21739130</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 fc.L_rm.1    3 0.9469114 0.10461157   0.952 0.0000000 0.00000000</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 fc.L_rm.1    4 0.7828763 0.12292367   0.700 0.2608696 0.34782609</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 fc.L_rm.2    1 0.8910421 0.02809108   0.788 0.0000000 0.04166667</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 fc.L_rm.2    2 0.8182386 0.06850754   0.648 0.1739130 0.21739130</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7 fc.L_rm.2    3 0.9471680 0.10297619   0.976 0.0000000 0.00000000</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8 fc.L_rm.2    4 0.7849721 0.12081335   0.592 0.2173913 0.43478261</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   proc_auc_ratio proc_pval</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       2.256309         0</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       2.310808         0</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       1.991820         0</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       2.296292         0</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       2.214087         0</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       2.278199         0</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7       1.997949         0</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8       2.278685         0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Yet another way to run <code>ENMevaluate()</code> is by specifying a new algorithm using the <code>ENMdetails</code> object. Built-in algorithms (maxent.jar, maxnet, BIOCLIM) are implemented as <code>ENMdetails</code> objects—they can be found in the /R folder of the package with the file name “enm.name”, where “name” is the algorithm. The <code>ENMdetails</code> object specifies the way <code>ENMevaluate()</code> should run the algorithm. It has some simple functions that output 1) the algorithm’s name, 2) the function that runs the algorithm, 3) particular messages or errors, 4) the arguments for the model’s function, 5) a specific parameterization of the <code>predict()</code> function, 6) the number of non-zero model coefficients, and 7) the variable importance table (if one is available from the model object).</p>
<p>Users can construct their own <code>ENMdetails</code> object using the built-in ones as guides. For example, a user can copy the “enm.maxnet.R” script, modify the code to specify a different model, save it as a new script in the /R folder with the name “enm.myAlgorithm”, and use it to run <code>ENMevaluate()</code>. To be able to specify the model with the <code>algorithm</code> argument in <code>ENMevaluate()</code>, a small modification needs to be made to add it to list in the <code>lookup.enm()</code> internal function found in “R/utilities.R”. We plan to work with other research groups to identify best practices for tuning other algorithms with presence-background/pseudoabsence data and implement new algorithms in ENMeval in the future.</p>
</section>
<section id="exploring-the-results" class="level4">
<h4 class="anchored" data-anchor-id="exploring-the-results">Exploring the results</h4>
<p>Now let’s take a look at the output from <code>ENMevaluate()</code>, which is an <code>ENMevaluation</code> object, in more detail (also see <code>?ENMevaluation</code>). It contains the following slots:</p>
<ul>
<li><code>algorithm</code> A character vector showing which algorithm was used</li>
<li><code>tune.settings</code> A data.frame of settings that were tuned</li>
<li><code>partition.method</code> A character of partitioning method used</li>
<li><code>partition.settings</code> A list of partition settings used (i.e., value of <em>k</em> or aggregation factor)</li>
<li><code>other.settings</code> A list of other modeling settings used (i.e., decisions about clamping, AUC diff calculation)</li>
<li><code>doClamp</code> A logical indicating whether or not clamping was used</li>
<li><code>clamp.directions</code> A list of the clamping directions specified</li>
<li><code>results</code> A data.frame of evaluation summary statistics</li>
<li><code>results.partitions</code> A data.frame of evaluation k-fold statistics</li>
<li><code>models</code> A list of model objects</li>
<li><code>variable.importance</code> A list of data frames with variable importance for each model (when applicable)</li>
<li><code>predictions</code> A RasterStack of model predictions</li>
<li><code>taxon.name</code> A character for taxon name (when specified)</li>
<li><code>occs</code> A data frame of the occurrence record coordinates used for model training</li>
<li><code>occs.testing</code> A data frame of the coordinates of the fully withheld testing records (when specified)</li>
<li><code>occs.grp</code> A vector of partition groups for occurrence records</li>
<li><code>bg</code> A data frame of background record coordinates used for model training</li>
<li><code>bg.grp</code> A vector of partition groups for background records</li>
<li><code>overlap</code> A list of matrices of pairwise niche overlap statistics</li>
<li><code>rmm</code> A list of rangeModelMetadata objects for each model</li>
</ul>
<p>Let’s first examine the structure of the object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>e.mx</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; An object of class:  ENMevaluation </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  occurrence/background points:  86 / 2672 </span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  partition method:  block </span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  partition settings:  orientation = lat_lon </span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  clamp:  left: bio1, bio12, bio16, bio17, bio5, bio6, bio7, bio8, biome</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          right: bio1, bio12, bio16, bio17, bio5, bio6, bio7, bio8, biome </span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  categoricals:  biome </span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  algorithm:  maxnet </span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  tune settings:  fc: L,LQ,LQH,H</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  rm: 1,2,3,4,5 </span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  overlap:  TRUE </span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Refer to ?ENMevaluation for information on slots.</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Simplify the summary to look at higher level items.</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(e.mx, <span class="at">max.level=</span><span class="dv">2</span>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formal class 'ENMevaluation' [package "ENMeval"] with 20 slots</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ algorithm          : chr "maxnet"</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ tune.settings      :'data.frame':  20 obs. of  3 variables:</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, "out.attrs")=List of 2</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ partition.method   : chr "block"</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ partition.settings :List of 1</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ other.settings     :List of 7</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ doClamp            : logi TRUE</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ clamp.directions   :List of 2</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ results            :'data.frame':  20 obs. of  19 variables:</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, "out.attrs")=List of 2</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ results.partitions :'data.frame':  80 obs. of  7 variables:</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ models             :List of 20</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ variable.importance:List of 20</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ predictions        :Formal class 'RasterStack' [package "raster"] with 12 slots</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ taxon.name         : chr ""</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ occs               :'data.frame':  86 obs. of  11 variables:</span></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ occs.testing       :'data.frame':  0 obs. of  0 variables</span></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ occs.grp           : Factor w/ 4 levels "1","2","3","4": 3 4 4 4 4 4 3 1 3 3 ...</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ bg                 :'data.frame':  2672 obs. of  11 variables:</span></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ bg.grp             : Factor w/ 4 levels "1","2","3","4": 4 2 2 2 1 2 2 1 3 2 ...</span></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ overlap            : list()</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..@ rmm                :List of 8</span></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, "class")= chr [1:2] "list" "RMM"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use helper functions to access the slots in the <code>ENMevaluation</code> object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Access algorithm, tuning settings, and partition method information.</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.algorithm</span>(e.mx)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "maxnet"</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.tune.settings</span>(e.mx) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    fc rm   tune.args</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   L  1   fc.L_rm.1</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  LQ  1  fc.LQ_rm.1</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 LQH  1 fc.LQH_rm.1</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   H  1   fc.H_rm.1</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   L  2   fc.L_rm.2</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  LQ  2  fc.LQ_rm.2</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.partition.method</span>(e.mx)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] "block"</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Results table with summary statistics for cross validation on test data.</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.results</span>(e.mx) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    fc rm   tune.args auc.train cbi.train auc.diff.avg auc.diff.sd auc.val.avg</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   L  1   fc.L_rm.1 0.7286241     0.939    0.1650150  0.10703048   0.5855066</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  LQ  1  fc.LQ_rm.1 0.7403043     0.900    0.1863273  0.10949631   0.5708008</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 LQH  1 fc.LQH_rm.1 0.7938135     0.980    0.1891301  0.10764310   0.6146578</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   H  1   fc.H_rm.1 0.8027042     0.965    0.2127961  0.13315319   0.5897126</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   L  2   fc.L_rm.2 0.7284457     0.955    0.1686882  0.10006587   0.5810924</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  LQ  2  fc.LQ_rm.2 0.7378760     0.901    0.1732604  0.08795931   0.5842226</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   auc.val.sd cbi.val.avg cbi.val.sd or.10p.avg or.10p.sd or.mtp.avg or.mtp.sd</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0.1207284     0.15525  0.5469609  0.2581169 0.1826184  0.1190476 0.1374643</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  0.1192016     0.07800  0.4605924  0.3062771 0.2142857  0.1769481 0.1427738</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  0.1378431     0.29650  0.3929652  0.3647186 0.2313319  0.2002165 0.1477104</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  0.1505330     0.15075  0.4579682  0.3874459 0.2236187  0.2353896 0.1695638</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  0.1222575     0.15450  0.5465519  0.2110390 0.1408258  0.1071429 0.1252360</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  0.1136612     0.09950  0.5184911  0.2824675 0.1894362  0.1309524 0.1620681</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       AICc delta.AICc        w.AIC ncoef</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1422.004  10.927275 3.139738e-03    13</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 1411.077   0.000000 7.408342e-01    15</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 1436.640  25.563242 2.083213e-06    28</span></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 1439.667  28.589594 4.587432e-07    27</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 1423.917  12.840083 1.206514e-03    10</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 1414.602   3.524918 1.271437e-01    13</span></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Results table with cross validation statistics for each test partition.</span></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.results.partitions</span>(e.mx) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    tune.args fold   auc.val   auc.diff cbi.val    or.mtp     or.10p</span></span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  fc.L_rm.1    1 0.7524014 0.03168203   0.772 0.0000000 0.00000000</span></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  fc.L_rm.1    2 0.4891685 0.27708225  -0.102 0.2380952 0.42857143</span></span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  fc.L_rm.1    3 0.5049400 0.21925815  -0.464 0.0000000 0.31818182</span></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  fc.L_rm.1    4 0.5955165 0.13203767   0.415 0.2380952 0.28571429</span></span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 fc.LQ_rm.1    1 0.7474957 0.02584477   0.721 0.0000000 0.09090909</span></span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 fc.LQ_rm.1    2 0.5234593 0.24225760  -0.109 0.3333333 0.38095238</span></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a><span class="co"># List of models with names corresponding to tune.args column label.</span></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.models</span>(e.mx) <span class="sc">%&gt;%</span> <span class="fu">str</span>(<span class="at">max.level =</span> <span class="dv">1</span>)</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 20</span></span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.L_rm.1  :List of 23</span></span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.LQ_rm.1 :List of 23</span></span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.LQH_rm.1:List of 23</span></span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.H_rm.1  :List of 23</span></span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.L_rm.2  :List of 23</span></span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.LQ_rm.2 :List of 23</span></span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.LQH_rm.2:List of 23</span></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.H_rm.2  :List of 23</span></span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.L_rm.3  :List of 23</span></span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.LQ_rm.3 :List of 23</span></span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.LQH_rm.3:List of 23</span></span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.H_rm.3  :List of 23</span></span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.L_rm.4  :List of 23</span></span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.LQ_rm.4 :List of 23</span></span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.LQH_rm.4:List of 23</span></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.H_rm.4  :List of 23</span></span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.L_rm.5  :List of 23</span></span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.LQ_rm.5 :List of 23</span></span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.LQH_rm.5:List of 23</span></span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ fc.H_rm.5  :List of 23</span></span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, "class")= chr [1:3] "maxnet" "lognet" "glmnet"</span></span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a><span class="co"># The "betas" slot in a maxnet model is a named vector of the variable </span></span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficients and what kind they are (in R formula notation).</span></span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that the html file that is created when maxent.jar is run is **not** kept.</span></span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a>m1.mx <span class="ot">&lt;-</span> <span class="fu">eval.models</span>(e.mx)[[<span class="st">"fc.LQH_rm.1"</span>]]</span>
<span id="cb53-93"><a href="#cb53-93" aria-hidden="true" tabindex="-1"></a>m1.mx<span class="sc">$</span>betas</span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                              bio12                               bio6 </span></span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       9.184332e-04                       5.887831e-03 </span></span>
<span id="cb53-96"><a href="#cb53-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                               bio7                         I(bio17^2) </span></span>
<span id="cb53-97"><a href="#cb53-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -3.231121e-03                      -4.162945e-06 </span></span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                          I(bio7^2)   hinge(bio1):229.061224489796:289 </span></span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -2.921926e-05                      -7.088779e-01 </span></span>
<span id="cb53-100"><a href="#cb53-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   hinge(bio1):234.510204081633:289 hinge(bio12):4076.63265306122:7682 </span></span>
<span id="cb53-101"><a href="#cb53-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -1.165063e-03                      -2.670397e-01 </span></span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    hinge(bio12):1:1255.04081632653    hinge(bio12):1:2038.81632653061 </span></span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       2.899905e+00                      -3.052320e-01 </span></span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    hinge(bio16):1:502.428571428571    hinge(bio16):1:753.142857142857 </span></span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       3.162182e+00                      -9.346829e-01 </span></span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    hinge(bio16):1:903.571428571429    hinge(bio16):1:953.714285714286 </span></span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -1.219462e+00                      -3.191405e-01 </span></span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    hinge(bio17):0:122.122448979592   hinge(bio5):303.183673469388:362 </span></span>
<span id="cb53-109"><a href="#cb53-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -2.759773e-01                      -1.560949e+00 </span></span>
<span id="cb53-110"><a href="#cb53-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   hinge(bio5):324.571428571429:362   hinge(bio5):340.612244897959:362 </span></span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       4.260652e-02                      -1.043404e+00 </span></span>
<span id="cb53-112"><a href="#cb53-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    hinge(bio6):200.65306122449:238    hinge(bio7):64:105.510204081633 </span></span>
<span id="cb53-113"><a href="#cb53-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -1.231830e-01                      -7.017860e-01 </span></span>
<span id="cb53-114"><a href="#cb53-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   hinge(bio8):263.979591836735:290               categorical(biome):2 </span></span>
<span id="cb53-115"><a href="#cb53-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       2.119202e+00                       1.361552e-02 </span></span>
<span id="cb53-116"><a href="#cb53-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               categorical(biome):3               categorical(biome):7 </span></span>
<span id="cb53-117"><a href="#cb53-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -3.479780e+00                      -8.398389e-01 </span></span>
<span id="cb53-118"><a href="#cb53-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               categorical(biome):9              categorical(biome):10 </span></span>
<span id="cb53-119"><a href="#cb53-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -1.558389e+00                      -1.899236e+00 </span></span>
<span id="cb53-120"><a href="#cb53-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              categorical(biome):13              categorical(biome):14 </span></span>
<span id="cb53-121"><a href="#cb53-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       7.187696e-01                      -1.972200e-01</span></span>
<span id="cb53-122"><a href="#cb53-122" aria-hidden="true" tabindex="-1"></a><span class="co"># the enframe function from the tibble package makes this named vector into a </span></span>
<span id="cb53-123"><a href="#cb53-123" aria-hidden="true" tabindex="-1"></a><span class="co"># more readable table.</span></span>
<span id="cb53-124"><a href="#cb53-124" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb53-125"><a href="#cb53-125" aria-hidden="true" tabindex="-1"></a><span class="fu">enframe</span>(m1.mx<span class="sc">$</span>betas)</span>
<span id="cb53-126"><a href="#cb53-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 28 × 2</span></span>
<span id="cb53-127"><a href="#cb53-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    name                                     value</span></span>
<span id="cb53-128"><a href="#cb53-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;                                    &lt;dbl&gt;</span></span>
<span id="cb53-129"><a href="#cb53-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 bio12                               0.000918  </span></span>
<span id="cb53-130"><a href="#cb53-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 bio6                                0.00589   </span></span>
<span id="cb53-131"><a href="#cb53-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 bio7                               -0.00323   </span></span>
<span id="cb53-132"><a href="#cb53-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 I(bio17^2)                         -0.00000416</span></span>
<span id="cb53-133"><a href="#cb53-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 I(bio7^2)                          -0.0000292 </span></span>
<span id="cb53-134"><a href="#cb53-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 hinge(bio1):229.061224489796:289   -0.709     </span></span>
<span id="cb53-135"><a href="#cb53-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 hinge(bio1):234.510204081633:289   -0.00117   </span></span>
<span id="cb53-136"><a href="#cb53-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 hinge(bio12):4076.63265306122:7682 -0.267     </span></span>
<span id="cb53-137"><a href="#cb53-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 hinge(bio12):1:1255.04081632653     2.90      </span></span>
<span id="cb53-138"><a href="#cb53-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 hinge(bio12):1:2038.81632653061    -0.305     </span></span>
<span id="cb53-139"><a href="#cb53-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ℹ 18 more rows</span></span>
<span id="cb53-140"><a href="#cb53-140" aria-hidden="true" tabindex="-1"></a><span class="co"># RasterStack of model predictions (for extent of "envs") with names corresponding </span></span>
<span id="cb53-141"><a href="#cb53-141" aria-hidden="true" tabindex="-1"></a><span class="co"># to tune.args column label.</span></span>
<span id="cb53-142"><a href="#cb53-142" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.predictions</span>(e.mx)</span>
<span id="cb53-143"><a href="#cb53-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; class      : RasterStack </span></span>
<span id="cb53-144"><a href="#cb53-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dimensions : 192, 186, 35712, 20  (nrow, ncol, ncell, nlayers)</span></span>
<span id="cb53-145"><a href="#cb53-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; resolution : 0.5, 0.5  (x, y)</span></span>
<span id="cb53-146"><a href="#cb53-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; extent     : -125, -32, -56, 40  (xmin, xmax, ymin, ymax)</span></span>
<span id="cb53-147"><a href="#cb53-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; crs        : +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs </span></span>
<span id="cb53-148"><a href="#cb53-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; names      :    fc.L_rm.1,   fc.LQ_rm.1,  fc.LQH_rm.1,    fc.H_rm.1,    fc.L_rm.2,   fc.LQ_rm.2,  fc.LQH_rm.2,    fc.H_rm.2,    fc.L_rm.3,   fc.LQ_rm.3,  fc.LQH_rm.3,    fc.H_rm.3,    fc.L_rm.4,   fc.LQ_rm.4,  fc.LQH_rm.4, ... </span></span>
<span id="cb53-149"><a href="#cb53-149" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; min values : 2.020046e-04, 1.311444e-05, 4.756764e-06, 6.193159e-06, 1.402772e-03, 3.033066e-04, 2.433804e-04, 8.172367e-04, 2.480332e-03, 1.689055e-03, 1.345775e-03, 6.300348e-03, 3.915767e-03, 3.326851e-03, 3.326851e-03, ... </span></span>
<span id="cb53-150"><a href="#cb53-150" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; max values :    0.9988868,    0.9985682,    0.9997592,    0.9996481,    0.9971575,    0.9966045,    0.9981007,    0.9938739,    0.9955334,    0.9930501,    0.9920990,    0.9806077,    0.9929774,    0.9867222,    0.9867222, ...</span></span>
<span id="cb53-151"><a href="#cb53-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Original occurrence data coordinates with associated predictor variable values.</span></span>
<span id="cb53-152"><a href="#cb53-152" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.occs</span>(e.mx) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb53-153"><a href="#cb53-153" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   longitude  latitude bio1 bio12 bio16 bio17 bio5 bio6 bio7 bio8 biome</span></span>
<span id="cb53-154"><a href="#cb53-154" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 -84.67201 10.478622  235  2779  1191   154  305  175  129  231     1</span></span>
<span id="cb53-155"><a href="#cb53-155" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 -76.79294  8.433710  261  2192   739   222  306  220   87  260     1</span></span>
<span id="cb53-156"><a href="#cb53-156" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 -80.12543  8.610270  259  2876  1119   163  315  214  101  253     1</span></span>
<span id="cb53-157"><a href="#cb53-157" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 -79.55048  8.952963  267  1912   851    54  322  223   99  262     1</span></span>
<span id="cb53-158"><a href="#cb53-158" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 -79.44806  9.225840  255  2539  1045   116  307  207  100  249     1</span></span>
<span id="cb53-159"><a href="#cb53-159" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 -75.02596  9.183511  272  1227   503    64  340  207  133  268     1</span></span>
<span id="cb53-160"><a href="#cb53-160" aria-hidden="true" tabindex="-1"></a><span class="co"># Background data coordinates with associated predictor variable values.</span></span>
<span id="cb53-161"><a href="#cb53-161" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.bg</span>(e.mx) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb53-162"><a href="#cb53-162" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    longitude latitude bio1 bio12 bio16 bio17 bio5 bio6 bio7 bio8 biome</span></span>
<span id="cb53-163"><a href="#cb53-163" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 87    -65.75     8.75  264  1114   612    17  335  198  138  260     7</span></span>
<span id="cb53-164"><a href="#cb53-164" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 88    -50.75    -0.25  270  2951  1289   186  326  228   98  264     1</span></span>
<span id="cb53-165"><a href="#cb53-165" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 89    -58.75    -0.25  265  2269  1008   269  326  214  113  261     1</span></span>
<span id="cb53-166"><a href="#cb53-166" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 90    -53.25    -5.75  250  1875   866    93  322  178  144  245     1</span></span>
<span id="cb53-167"><a href="#cb53-167" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 91    -75.75     3.25  163  2220   765   323  218  112  106  160     1</span></span>
<span id="cb53-168"><a href="#cb53-168" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 92    -46.25    -1.75  266  2281  1012   128  323  216  107  261     1</span></span>
<span id="cb53-169"><a href="#cb53-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Partition group assignments for occurrence data.</span></span>
<span id="cb53-170"><a href="#cb53-170" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.occs.grp</span>(e.mx) <span class="sc">%&gt;%</span> <span class="fu">str</span>()</span>
<span id="cb53-171"><a href="#cb53-171" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Factor w/ 4 levels "1","2","3","4": 3 4 4 4 4 4 3 1 3 3 ...</span></span>
<span id="cb53-172"><a href="#cb53-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Partition group assignments for background data.</span></span>
<span id="cb53-173"><a href="#cb53-173" aria-hidden="true" tabindex="-1"></a><span class="fu">eval.bg.grp</span>(e.mx) <span class="sc">%&gt;%</span> <span class="fu">str</span>()</span>
<span id="cb53-174"><a href="#cb53-174" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Factor w/ 4 levels "1","2","3","4": 4 2 2 2 1 2 2 1 3 2 ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Maxent models run with <code>maxent.jar</code> have a different structure from models run with <code>maxnet</code>, so below is a demonstration of how to extract the “betas” information for <code>maxent.jar</code> models. In the case that the user can run <code>maxent.jar</code>, please run these lines independently. As many users have issues running the Java version of Maxent, this portion is not automatically evaluated for the vignette to avoid R Markdown knitting errors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co"> -- This code is not evaluated and so will display no output in this vignette.</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Please run independently.</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For maxent.jar models, we can access this information in the lambdas slot.</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>m1.mxjar <span class="ot">&lt;-</span> <span class="fu">eval.models</span>(e.mxjar)[[<span class="st">"fc.LQH_rm.1"</span>]]</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>m1.mxjar<span class="sc">@</span>lambdas</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The notation used here is difficult to decipher, so check out the </span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># [`rmaxent`](https://github.com/johnbaums/rmaxent/blob/master/) package.</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># available on Github for the `parse_lambdas()` function that makes it easier to read.</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"johnbaums/rmaxent"</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>rmaxent<span class="sc">::</span><span class="fu">parse_lambdas</span>(m1.mxjar)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co"># We can also get a long list of results statistics from the results slot.</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>m1.mxjar<span class="sc">@</span>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="plot" class="level2">
<h2 class="anchored" data-anchor-id="plot">Visualizing tuning results</h2>
<p><code>ENMeval</code> 2.0 has a built-in plotting function (<code>eval.plot</code>) to visualize the results of the different models you tuned in a ggplot. Here, we will plot average validation AUC and omission rates for the models we tuned. The x-axis is the regularization multiplier, and the color of the points and lines represents the feature class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.stats</span>(<span class="at">e =</span> e.mx, <span class="at">stats =</span> <span class="st">"or.mtp"</span>, <span class="at">color =</span> <span class="st">"fc"</span>, <span class="at">x.var =</span> <span class="st">"rm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/plot.res-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can plot more than one statistic at once with ggplot facetting.</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.stats</span>(<span class="at">e =</span> e.mx, <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"or.mtp"</span>, <span class="st">"auc.val"</span>), <span class="at">color =</span> <span class="st">"fc"</span>, <span class="at">x.var =</span> <span class="st">"rm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/plot.res-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sometimes the error bars make it hard to visualize the plot, so we can try turning them off.</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.stats</span>(<span class="at">e =</span> e.mx, <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"or.mtp"</span>, <span class="st">"auc.val"</span>), <span class="at">color =</span> <span class="st">"fc"</span>, <span class="at">x.var =</span> <span class="st">"rm"</span>, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">error.bars =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/plot.res-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can also fiddle with the dodge argument to jitter the positions of overlapping points.</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.stats</span>(<span class="at">e =</span> e.mx, <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"or.mtp"</span>, <span class="st">"auc.val"</span>), <span class="at">color =</span> <span class="st">"fc"</span>, <span class="at">x.var =</span> <span class="st">"rm"</span>, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">dodge =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/plot.res-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we can switch which variables are on the x-axis and which symbolized by color.</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ENMeval currently only accepts two variables for plotting at a time.</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.stats</span>(<span class="at">e =</span> e.mx, <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"or.mtp"</span>, <span class="st">"auc.val"</span>), <span class="at">color =</span> <span class="st">"rm"</span>, <span class="at">x.var =</span> <span class="st">"fc"</span>, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">error.bars =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/plot.res-5.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="select" class="level2">
<h2 class="anchored" data-anchor-id="select">Model selection</h2>
<p>Once we have our results, we will want to select one or more models that we think are optimal across all the models we ran. For this example, we will demonstrate how to select models without considering cross-validation results using AICc (Warren &amp; Seifert 2011; but see Velasco &amp; González-Salazar 2019) and a sequential method that uses cross-validation results by selecting models with the lowest average test omission rate, and to break ties, with the highest average validation AUC (Radosavljevic &amp; Anderson 2014, Kass et al.&nbsp;2020). Lobo et al.&nbsp;(2008) and others have pointed out that validation AUC is inappropriate as an absolute performance measure of presence-background ENMs, but it is valid to use for relative comparisons of models constructed with the same data. It is important to note that <code>ENMeval</code> 2.0 also returns the continuous Boyce Index (Hirzel et al.&nbsp;2006) for training, validation, and fully withheld testing data by default using the R package <code>ecospat</code> (Di Cola et al.&nbsp;2017), so this metric can be used to select optimal models as well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall results</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">eval.results</span>(e.mx)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the model with delta AICc equal to 0, or the one with the lowest AICc score.</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># In practice, models with delta AICc scores less than 2 are usually considered </span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># statistically equivalent.</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>opt.aicc <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> <span class="fu">filter</span>(delta.AICc <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>opt.aicc</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   fc rm  tune.args auc.train cbi.train auc.diff.avg auc.diff.sd auc.val.avg</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 LQ  1 fc.LQ_rm.1 0.7403043       0.9    0.1863273   0.1094963   0.5708008</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   auc.val.sd cbi.val.avg cbi.val.sd or.10p.avg or.10p.sd or.mtp.avg or.mtp.sd</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0.1192016       0.078  0.4605924  0.3062771 0.2142857  0.1769481 0.1427738</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       AICc delta.AICc     w.AIC ncoef</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1411.077          0 0.7408342    15</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># This dplyr operation executes the sequential criteria explained above.</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>opt.seq <span class="ot">&lt;-</span> res <span class="sc">%&gt;%</span> </span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(or<span class="fl">.10</span>p.avg <span class="sc">==</span> <span class="fu">min</span>(or<span class="fl">.10</span>p.avg)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(auc.val.avg <span class="sc">==</span> <span class="fu">max</span>(auc.val.avg))</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>opt.seq</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   fc rm tune.args auc.train cbi.train auc.diff.avg auc.diff.sd auc.val.avg</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  L  5 fc.L_rm.5 0.7213045     0.965     0.158632   0.0734464   0.6020335</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   auc.val.sd cbi.val.avg cbi.val.sd or.10p.avg or.10p.sd or.mtp.avg  or.mtp.sd</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0.1226668      0.2855  0.3995835  0.1547619  0.179758 0.07142857 0.09118353</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       AICc delta.AICc       w.AIC ncoef</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 1423.208   12.13092 0.001719991     7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s now choose the optimal model settings based on the sequential criteria and examine it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can select a single model from the ENMevaluation object using the tune.args of our</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="co"># optimal model.</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>mod.seq <span class="ot">&lt;-</span> <span class="fu">eval.models</span>(e.mx)[[opt.seq<span class="sc">$</span>tune.args]]</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Here are the non-zero coefficients in our model.</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>mod.seq<span class="sc">$</span>betas</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 bio12                 bio17                  bio5 </span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          0.0004151502         -0.0017804885         -0.0025126393 </span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  bio7  categorical(biome):3  categorical(biome):7 </span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         -0.0193498464         -1.3460097168         -0.7918604926 </span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; categorical(biome):10 </span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         -1.0665442126</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co"># And these are the marginal response curves for the predictor variables wit non-zero </span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co"># coefficients in our model. We define the y-axis to be the cloglog transformation, which</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="co"># is an approximation of occurrence probability (with assumptions) bounded by 0 and 1</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (Phillips et al. 2017).</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.seq, <span class="at">type =</span> <span class="st">"cloglog"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/mod.obj1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The above function plots with graphical customizations to include multiple plots on </span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the same page. </span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear the graphics device to avoid plotting sequential plots with these settings.</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; null device </span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is how to view the marginal response curves for <code>maxent.jar</code> models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co"> -- This code is not evaluated and so will display no output in this vignette.</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Please run independently.</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># maxent.jar models use the dismo::response() function for this</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>dismo<span class="sc">::</span><span class="fu">response</span>(<span class="fu">eval.models</span>(e.mxjar)[[opt.seq<span class="sc">$</span>tune.args]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we plot and inspect the prediction raster for our optimal model. Note that by default for <code>maxent.jar</code> (versions &gt;3.3.3k) or <code>maxnet</code> models, these predictions are in the ‘cloglog’ output format that is bounded between 0 and 1 (Phillips et al.&nbsp;2017). This can be changed with the <code>pred.type</code> argument in <code>ENMevaluate()</code>.</p>
<p>These predictions are for the entire extent of the input predictor variable rasters, and thus include areas outside of the background extent used for model training. Thus, we should interpret areas far outside this extent with caution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can select the model predictions for our optimal model the same way we did for the </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># model object above.</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>pred.seq <span class="ot">&lt;-</span> <span class="fu">eval.predictions</span>(e.mx)[[opt.seq<span class="sc">$</span>tune.args]]</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pred.seq)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We can also plot the binned background points with the occurrence points on top to </span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize where the training data is located.</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">eval.bg</span>(e.mx), <span class="at">pch =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="fu">eval.bg.grp</span>(e.mx), <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">eval.occs</span>(e.mx), <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="fu">eval.occs.grp</span>(e.mx))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/plotPred-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let us now explore how model complexity changes the predictions in our example. We will compare the simple model built with only linear feature classes and the highest regularization multiplier value we used (fc=‘L’, rm=5) with the complex model built with linear, quadratic, and hinge feature classes and the lowest regularization multiplier value we used (i.e., fc=‘LQH’, rm=1). We will first examine the marginal response curves, and then the mapped model model predictions. Notice how the simpler models tend to have more smooth predictions of suitability, while the complex ones tend to show more patchiness. Deciding on whether a model that is more simple or complex is appropriate for your study is not straightforward, but guides exist in the literature (e.g., Merow et al.&nbsp;2014).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let's examine the non-zero model coefficients in the betas slot.</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The simpler model has fewer model coefficients.</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>mod.simple <span class="ot">&lt;-</span> <span class="fu">eval.models</span>(e.mx)[[<span class="st">'fc.L_rm.5'</span>]]</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>mod.complex <span class="ot">&lt;-</span> <span class="fu">eval.models</span>(e.mx)[[<span class="st">'fc.LQH_rm.1'</span>]]</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>mod.simple<span class="sc">$</span>betas</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 bio12                 bio17                  bio5 </span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          0.0004151502         -0.0017804885         -0.0025126393 </span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  bio7  categorical(biome):3  categorical(biome):7 </span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         -0.0193498464         -1.3460097168         -0.7918604926 </span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; categorical(biome):10 </span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         -1.0665442126</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(mod.simple<span class="sc">$</span>betas)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 7</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>mod.complex<span class="sc">$</span>betas</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                              bio12                               bio6 </span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       9.184332e-04                       5.887831e-03 </span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                               bio7                         I(bio17^2) </span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -3.231121e-03                      -4.162945e-06 </span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                          I(bio7^2)   hinge(bio1):229.061224489796:289 </span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -2.921926e-05                      -7.088779e-01 </span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   hinge(bio1):234.510204081633:289 hinge(bio12):4076.63265306122:7682 </span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -1.165063e-03                      -2.670397e-01 </span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    hinge(bio12):1:1255.04081632653    hinge(bio12):1:2038.81632653061 </span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       2.899905e+00                      -3.052320e-01 </span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    hinge(bio16):1:502.428571428571    hinge(bio16):1:753.142857142857 </span></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       3.162182e+00                      -9.346829e-01 </span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    hinge(bio16):1:903.571428571429    hinge(bio16):1:953.714285714286 </span></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -1.219462e+00                      -3.191405e-01 </span></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    hinge(bio17):0:122.122448979592   hinge(bio5):303.183673469388:362 </span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -2.759773e-01                      -1.560949e+00 </span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   hinge(bio5):324.571428571429:362   hinge(bio5):340.612244897959:362 </span></span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       4.260652e-02                      -1.043404e+00 </span></span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    hinge(bio6):200.65306122449:238    hinge(bio7):64:105.510204081633 </span></span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -1.231830e-01                      -7.017860e-01 </span></span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   hinge(bio8):263.979591836735:290               categorical(biome):2 </span></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       2.119202e+00                       1.361552e-02 </span></span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               categorical(biome):3               categorical(biome):7 </span></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -3.479780e+00                      -8.398389e-01 </span></span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               categorical(biome):9              categorical(biome):10 </span></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      -1.558389e+00                      -1.899236e+00 </span></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              categorical(biome):13              categorical(biome):14 </span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       7.187696e-01                      -1.972200e-01</span></span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(mod.complex<span class="sc">$</span>betas)</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 28</span></span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Next, let's take a look at the marginal response curves.</span></span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a><span class="co"># The complex model has marginal responses with more curves (from quadratic terms) and </span></span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a><span class="co"># spikes (from hinge terms).</span></span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.simple, <span class="at">type =</span> <span class="st">"cloglog"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/plot.pred2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod.complex, <span class="at">type =</span> <span class="st">"cloglog"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/plot.pred2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, let's cut the plotting area into two rows to visualize the predictions </span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co"># side-by-side.</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The simplest model: linear features only and high regularization.</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">eval.predictions</span>(e.mx)[[<span class="st">'fc.L_rm.5'</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">20</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">90</span>,<span class="sc">-</span><span class="dv">30</span>), </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">'L_5 prediction'</span>)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The most complex model: linear, quadratic, and hinge features with low regularization</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">eval.predictions</span>(e.mx)[[<span class="st">'fc.LQH_rm.1'</span>]], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">30</span>,<span class="dv">20</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">90</span>,<span class="sc">-</span><span class="dv">30</span>), </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">'LQH_1 prediction'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/plot.pred2-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="null" class="level2">
<h2 class="anchored" data-anchor-id="null">Null models</h2>
<p>We were able to calculate performance metrics for our model, such as omission rates and AUC, but we do not know how they compare to the same metrics calculated on null models built with random data. This information would allow us to determine the significance and effect sizes of these metrics. If the metrics we calculated for our empirical model were not significantly different from those calculated for a series of null models, we would have not have high confidence that they meaningfully represent how well our empirical model performed. Raes &amp; ter Steege (2007) first introduced the concept of a null ENM and demonstrated how it can be applied. This approach sampled random occurrence records from the study extent and evaluated null models with random cross-validation. Since then some enhancements have been made to this original approach. One such modification was implemented by Bohl et al.&nbsp;(2019), who proposed evaluating models on the same withheld occurrence data as the empirical model. This approach allows for direct comparisons between null performance metrics and those of the emprical models. Kass et al.&nbsp;(2020) further extended this method by configuring it to calculate null performance metrics using spatial partitions.</p>
<p><code>ENMeval</code> 2.0 has the functionality to run null ENMs using the Bohl et al.&nbsp;method with the Kass et al.&nbsp;extension and visualize the performance of the empirical model against the null model averages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We first run the null simulations with 100 iterations to get a reasonable null distribution </span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># for comparisons with the empirical values</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>mod.null <span class="ot">&lt;-</span> <span class="fu">ENMnulls</span>(e.mx, <span class="at">mod.settings =</span> <span class="fu">list</span>(<span class="at">fc =</span> <span class="st">"LQ"</span>, <span class="at">rm =</span> <span class="dv">5</span>), <span class="at">no.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can inspect the results of each null simulation.</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">null.results</span>(mod.null) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   fc rm  tune.args auc.train cbi.train auc.diff.avg auc.diff.sd auc.val.avg</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 LQ  5 fc.LQ_rm.5 0.6142152     0.829    0.1207634  0.11625125   0.4881144</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 LQ  5 fc.LQ_rm.5 0.6912721     0.862    0.2515661  0.15744594   0.4821132</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 LQ  5 fc.LQ_rm.5 0.6523017     0.926    0.1432577  0.14194152   0.5564820</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 LQ  5 fc.LQ_rm.5 0.6456697     0.612    0.1210827  0.09182284   0.5186886</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 LQ  5 fc.LQ_rm.5 0.6561682     0.876    0.1526467  0.07700910   0.4754649</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 LQ  5 fc.LQ_rm.5 0.6339097     0.879    0.1741656  0.08798945   0.6067067</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   auc.val.sd cbi.val.avg cbi.val.sd or.10p.avg  or.10p.sd or.mtp.avg  or.mtp.sd</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.08150622          NA         NA 0.11363636 0.13636364 0.03409091 0.04351941</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.22848940     0.03650  0.6981549 0.34577922 0.28558512 0.05735931 0.04334412</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.14452994     0.21275  0.5132766 0.10227273 0.11954344 0.05681818 0.06818182</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0.05639411     0.10625  0.5958833 0.11417749 0.10775330 0.04599567 0.06429154</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 0.07919749     0.00300  0.4616586 0.17532468 0.18442778 0.02326840 0.02688256</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 0.18127970     0.09500  0.5239962 0.07954545 0.09370695 0.03409091 0.06818182</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ncoef</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     8</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     6</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     8</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     8</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     9</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     5</span></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a><span class="co"># And even inspect the results of each partition of each null simulation.</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a><span class="fu">null.results.partitions</span>(mod.null) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   iter  tune.args fold   auc.val   auc.diff cbi.val     or.mtp    or.10p</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    1 fc.LQ_rm.5    1 0.5276822 0.12992868  -0.011 0.04545455 0.1818182</span></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    1 fc.LQ_rm.5    2 0.4735277 0.04928758  -0.543 0.00000000 0.0000000</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    1 fc.LQ_rm.5    3 0.3811798 0.28116456  -0.568 0.09090909 0.2727273</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    1 fc.LQ_rm.5    4 0.5700680 0.02267295      NA 0.00000000 0.0000000</span></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    2 fc.LQ_rm.5    1 0.5724811 0.12409453   0.049 0.09090909 0.2727273</span></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    2 fc.LQ_rm.5    2 0.3219760 0.33117520   0.031 0.04761905 0.4285714</span></span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a><span class="co"># For a summary, we can look at a comparison between the empirical and simulated results.</span></span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a><span class="fu">null.emp.results</span>(mod.null)</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   statistic    auc.train  cbi.train    auc.diff    auc.val     cbi.val</span></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  emp.mean 0.7534669788 0.97100000  0.15401576 0.63839771  0.35350000</span></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    emp.sd           NA         NA  0.06391321 0.11524778  0.33818585</span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 null.mean 0.6501834164 0.83854000  0.17560369 0.49596295 -0.03396970</span></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   null.sd 0.0278775577 0.10071586  0.05898199 0.07383716  0.26084162</span></span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    zscore 3.7048999554 1.31518506 -0.36600887 1.92903902  1.48545963</span></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    pvalue 0.0001057371 0.09422386  0.35717923 0.02686301  0.06871106</span></span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        or.10p     or.mtp</span></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0.20021645 0.09523810</span></span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  0.12770563 0.16030960</span></span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  0.21027597 0.05372835</span></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  0.10252266 0.04620968</span></span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 -0.09812001 0.89829099</span></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  0.46091850 0.81548478</span></span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we can make plots of the null model results as a histogram.</span></span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.nulls</span>(mod.null, <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"or.10p"</span>, <span class="st">"auc.val"</span>), <span class="at">plot.type =</span> <span class="st">"histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or we can visualize the results with a violin plot.</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">evalplot.nulls</span>(mod.null, <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"or.10p"</span>, <span class="st">"auc.val"</span>), <span class="at">plot.type =</span> <span class="st">"violin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ENMeval_tutorial_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="metadata" class="level2">
<h2 class="anchored" data-anchor-id="metadata">Metadata</h2>
<p>The last point this vignette will discuss is extremely important for all scientific research: reproducibility. <code>ENMeval</code> 2.0 now catalogs details of the analysis essential for reproducibility in a <code>rangeModelMetadata</code> object, accessible from the output ENMevaluation object. The framework and philosophy behind <code>rangeModelMetadata</code> is described by Merow et al.&nbsp;(2019), and other related efforts to define crucial metadata standards and rating systems for ENMs have come out since (e.g., Araújo et al.&nbsp;2019, Feng et al.&nbsp;2019, Zurell et al.&nbsp;2020). Metadata generated by <code>ENMeval</code> can be saved to a CSV file for sharing with collaborators or for use in supplemental information for a manuscript, etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a rangeModelMetadata object based on the information stored in the </span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ENMevaluate object.</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>rmm <span class="ot">&lt;-</span> <span class="fu">eval.rmm</span>(e.mx)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We can fill in the model selection rules based on the sequential criteria we chose.</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>rmm<span class="sc">$</span>model<span class="sc">$</span>selectionRules <span class="ot">&lt;-</span> <span class="st">"lowest 10 percentile omission rate, </span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="st">break ties with average validation AUC"</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We can also enter our optimal model settings and the details of our optimal </span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># model's prediction.</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>rmm<span class="sc">$</span>model<span class="sc">$</span>finalModelSettings <span class="ot">&lt;-</span> <span class="st">"LQ4"</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>rmm<span class="sc">$</span>prediction<span class="sc">$</span>continuous<span class="sc">$</span>minVal <span class="ot">&lt;-</span> <span class="fu">cellStats</span>(pred.seq, min)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>rmm<span class="sc">$</span>prediction<span class="sc">$</span>continuous<span class="sc">$</span>maxVal <span class="ot">&lt;-</span> <span class="fu">cellStats</span>(pred.seq, max)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>rmm<span class="sc">$</span>prediction<span class="sc">$</span>continuous<span class="sc">$</span>units <span class="ot">&lt;-</span> <span class="st">"suitability (cloglog transformation)"</span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="co"># This is just an example -- there may be more fields relevant to fill in for your study.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we can save the metadata to a CSV file.</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>rangeModelMetadata<span class="sc">::</span><span class="fu">rmmToCSV</span>(rmm, <span class="st">"rmm_mx1.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">References and Resources</h2>
<p>This list of references and resources is not exhaustive by any means, and mainly includes those sources we referenced in the vignette text. The field is expanding further every year, and there are many other papers and packages that one learning about ENMs should explore.</p>
<section id="web-resources" class="level6">
<h6 class="anchored" data-anchor-id="web-resources">Web Resources</h6>
<ul>
<li><p><a href="https://rspatial.org/raster/sdm/">Hijmans, R. &amp; Elith, J. (2021) Species distribution modeling.</a></p></li>
<li><p><a href="https://groups.google.com/forum/embed/#!forum/maxent">Maxent Google Group</a></p></li>
<li><p><a href="https://biodiversityinformatics.amnh.org/open_source/maxent/Maxent_tutorial_2021.pdf">Phillips, S. J. (2021) A brief tutorial on Maxent. AT&amp;T Research. Available at: https://biodiversityinformatics.amnh.org/open_source/maxent/Maxent_tutorial_2021.pdf</a></p></li>
<li><p><a href="https://www.molecularecologist.com/2013/04/species-distribution-models-in-r/">Yoder, J. (2013). Species distribution models in R. The Molecular Ecologist.</a></p></li>
</ul>
</section>
<section id="general-guides" class="level6">
<h6 class="anchored" data-anchor-id="general-guides">General Guides</h6>
<ul>
<li><p><a href="https://doi.org/10.1126/sciadv.aat4858">Araújo, M. B., Anderson, R. P., Barbosa, A. M., Beale, C. M., Dormann, C. F., Early, R., Garcia, R. A., Guisan, A., Maiorano, L., Naimi, B., &amp; O’Hara, R. B. (2019). Standards for distribution models in biodiversity assessments. Science Advances, 5: eaat4858.</a></p></li>
<li><p><a href="https://doi.org/10.1017/CBO9780511810602">Franklin, J. (2010). Mapping species distributions: spatial inference and prediction. Cambridge University Press.</a></p></li>
<li><p><a href="https://doi.org/10.1017/9781139028271">Guisan A., Thuiller W., &amp; Zimmermann N. E. (2017). Habitat Suitability and Distribution Models with Applications in R. Cambridge University Press, Cambridge, UK.</a></p></li>
<li><p><a href="https://doi.org/10.1111/ecog.00845">Merow, C., Smith, M. J., Edwards Jr, T. C., Guisan, A., McMahon, S. M., Normand, S., Thuiller, W., Wüest, R. O., Zimmermann, N. E., &amp; Elith, J. (2014). What do we gain from simplicity versus complexity in species distribution models? Ecography, 37: 1267–1281.</a></p></li>
<li><p><a href="https://press.princeton.edu/titles/9641.html">Peterson, A.T., Soberón, J., Pearson, R.G., Anderson, R.P., Martínez-Meyer, E., Nakamura, M., &amp; Araújo, M.B. (2011) Ecological Niches and Geographic Distributions. Monographs in Population Biology, 49. Princeton University Press.</a></p></li>
</ul>
<p>-<a href="https://doi.org/10.1016/j.ecolmodel.2008.11.010">VanDerWal, J., Shoo, L. P., Graham, C., &amp; Williams, S. E. (2009). Selecting pseudo-absence data for presence-only distribution modeling: how far should you stray from what you know?. Ecological Modelling, 220: 589-594.</a></p>
</section>
<section id="maxent" class="level6">
<h6 class="anchored" data-anchor-id="maxent">Maxent</h6>
<ul>
<li><p><a href="https://doi.org/10.1111/j.1472-4642.2010.00725.x">Elith, J., Phillips, S. J., Hastie, T., Dudík, M., Chee, Y. E., &amp; Yates, C. J. (2011). A statistical explanation of MaxEnt for ecologists. Diversity and Distributions, 17(1), 43-57.</a></p></li>
<li><p><a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1600-0587.2013.07872.x">Merow, C., Smith, M., &amp; Silander, J.A. (2013). A practical guide to Maxent: what it does, and why inputs and settings matter. Ecography, 36, 1-12.</a></p></li>
<li><p><a href="https://doi.org/10.1016/j.ecolmodel.2005.03.026">Phillips, S. J., Anderson, R. P., &amp; Schapire, R. E. (2006). Maximum entropy modeling of species geographic distributions. Ecological Modelling, 190: 231–259.</a></p></li>
<li><p><a href="https://doi.org/10.1111/j.0906-7590.2008.5203.x">Phillips, S. J., &amp; Dudík, M. (2008). Modeling of species distributions with Maxent: new extensions and a comprehensive evaluation. Ecography, 31: 161-175.</a></p></li>
<li><p><a href="https://doi.org/10.1111/ecog.03049">Phillips, S. J., Anderson, R. P., Dudík, M., Schapire, R. E., &amp; Blair, M. E. (2017). Opening the black box: an open-source release of Maxent. Ecography, 40: 887–893.</a></p></li>
</ul>
</section>
<section id="environmental-and-niche-similarity" class="level6">
<h6 class="anchored" data-anchor-id="environmental-and-niche-similarity">Environmental and Niche Similarity</h6>
<ul>
<li><p><a href="https://doi.org/10.1111/j.2041-210X.2010.00036.x">Elith, J., Kearney, M., &amp; Phillips, S. (2010). The art of modelling range‐shifting species. Methods in Ecology and Evolution, 1(4), 330-342.</a></p></li>
<li><p><a href="https://doi.org/10.1007/s10531-009-9584-8">Fitzpatrick, M. C., &amp; Hargrove, W. W. (2009). The projection of species distribution models and the problem of non-analog climate. Biodiversity and Conservation, 18(8), 2255-2261.</a></p></li>
<li><p><a href="https://doi.org/10.1111/ddi.12209">Mesgaran, M. B., Cousens, R. D., &amp; Webber, B. L. (2014). Here be dragons: a tool for quantifying novelty due to covariate range and correlation change when projecting species distribution models. Diversity and Distributions, 20: 1147-1159.</a></p></li>
<li><p><a href="https://doi.org/10.1016/j.ecolmodel.2013.04.011">Owens, H. L., Campbell, L. P., Dornak, L. L., Saupe, E. E., Barve, N., Soberón, J., … &amp; Peterson, A. T. (2013). Constraints on interpretation of ecological niche models by limited environmental ranges on calibration areas. Ecological Modelling, 263, 10-18.</a></p></li>
<li><p><a href="https://dx.doi.org/10.1111/j.1558-5646.2008.00482.x">Warren, D. L., Glor, R. E., &amp; Turelli, M. (2008). Environmental niche equivalency versus conservatism: quantitative approaches to niche evolution. Evolution: International Journal of Organic Evolution, 62: 2868-2883.</a></p></li>
</ul>
</section>
<section id="model-evaluation" class="level6">
<h6 class="anchored" data-anchor-id="model-evaluation">Model Evaluation</h6>
<ul>
<li><p><a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/ecog.01132">Aiello-Lammens, M.E., Boria, R.A., Radosavljevic, A., Vilela, B., &amp; Anderson, R.P. (2015) spThin: an R package for spatial thinning of species occurrence records for use in ecological niche models. Ecography, 38, 541-545.</a></p></li>
<li><p><a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.463.359&amp;rep=rep1&amp;type=pdf">Fielding, A.H. &amp; Bell, J.F. (1997). A review of methods for the assessment of prediction errors in conservation presence-absence models. Environmental Conservation 24, 38-49.</a></p></li>
<li><p><a href="https://doi.org/10.1016/j.ecolmodel.2019.108719">Hallgren, W., Santana, F., Low-Choy, S., Zhao, Y., &amp; Mackey, B. (2019). Species distribution models can be highly sensitive to algorithm configuration. Ecological Modelling, 408: 108719.</a></p></li>
<li><p><a href="https://web.stanford.edu/~hastie/ElemStatLearn/">Hastie, T., Tibshirani, R., &amp; Friedman, J. (2009). The Elements of Statistical Learning: Data Mining, Inference, and Prediction. Springer, New York, NY.</a></p></li>
<li><p><a href="https://doi.org/10.1016/j.ecolmodel.2006.05.017">Hirzel, A. H., Le Lay, G., Helfer, V., Randin, C., &amp; Guisan, A. (2006). Evaluating the ability of habitat suitability models to predict species presences. Ecological Modelling, 199: 142-152.</a></p></li>
<li><p><a href="https://doi.org/10.1111/ecog.04886">Kass, J. M., Anderson, R. P., Espinosa‐Lucas, A., Juárez‐Jaimes, V., Martínez‐Salas, E., Botello, F., Tavera, G., Flores‐Martínez, J. J., &amp; Sánchez‐Cordero, V. (2020). Biotic predictors with phenological information improve range estimates for migrating monarch butterflies in Mexico. Ecography, 43(3), 341-352.</a></p></li>
<li><p><a href="https://doi.org/10.1111/j.1466-8238.2007.00358.x">Lobo, J. M., Jiménez‐Valverde, A., &amp; Real, R. (2008). AUC: a misleading measure of the performance of predictive distribution models. Global ecology and Biogeography, 17: 145-151.</a></p></li>
<li><p><a href="https://doi.org/10.1111/j.1365-2699.2006.01594.x">Pearson, R.G., Raxworthy, C.J., Nakamura, M., &amp; Peterson, A.T. (2007) Predicting species distributions from small numbers of occurrence records: a test case using cryptic geckos in Madagascar. Journal of Biogeography 34, 102-117.</a></p></li>
<li><p><a href="http://dx.doi.org/10.1016/j.ecolmodel.2007.11.008">Peterson, A. T., Papeş, M., &amp; Soberón, J. (2008). Rethinking receiver operating characteristic analysis applications in ecological niche modeling. Ecological Modelling, 213: 63-72.</a></p></li>
<li><p><a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/jbi.12227">Radosavljevic, A. &amp; Anderson, R.P. (2014). Making better Maxent models of species distributions: complexity, overfitting and evaluation. Journal of Biogeography 41, 629-643.</a></p></li>
<li><p><a href="https://doi.org/10.1111/ecog.02881">Roberts, D. R., Bahn, V., Ciuti, S., Boyce, M. S., Elith, J., Guillera‐Arroita, G., Hauenstein, S., Lahoz‐Monfort, J. J., Schröder, B., Thuiller, W., &amp; Warton, D. I. (2017). Cross-validation strategies for data with temporal, spatial, hierarchical, or phylogenetic structure. Ecography, 40: 913–929.</a></p></li>
<li><p><a href="https://www.sciencedirect.com/science/article/pii/S0304380013004043">Shcheglovitova, M. &amp; Anderson, R.P. (2013). Estimating optimal complexity for ecological niche models: A jackknife approach for species with small sample sizes. Ecological Modelling 269: 9-17.</a></p></li>
<li><p><a href="https://doi.org/10.1016/j.ecoinf.2019.02.005">Velasco, J. A. &amp; González-Salazar, C. (2019). Akaike information criterion should not be a “test” of geographical prediction accuracy in ecological niche modelling. Ecological Informatics, 51: 25–32.</a></p></li>
<li><p><a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1365-2699.2009.02174.x">Veloz, S.D. (2009) Spatially autocorrelated sampling falsely inflates measures of accuracy for presence-only niche models. Journal of Biogeography 36: 2290-2299.</a></p></li>
<li><p><a href="https://doi.org/10.1890/10-1171.1">Warren, D. L. &amp; Seifert, S. N. (2011). Ecological niche modeling in Maxent: the importance of model complexity and the performance of model selection criteria. Ecological Applications, 21: 335–342.</a></p></li>
</ul>
</section>
<section id="null-enms" class="level6">
<h6 class="anchored" data-anchor-id="null-enms">Null ENMs</h6>
<ul>
<li><p><a href="https://doi.org/10.1111/jbi.13573">Bohl, C. L., Kass, J. M., &amp; Anderson, R. P. (2019). A new null model approach to quantify performance and significance for ecological niche models of species distributions. Journal of Biogeography, 46: 1101-1111.</a></p></li>
<li><p><a href="https://www.jstor.org/stable/30244521">Raes, N., &amp; ter Steege, H. (2007). A null-model for significance testing of presence-only species distribution models. Ecography, 30(5), 727-736.</a></p></li>
</ul>
</section>
<section id="model-transfer" class="level6">
<h6 class="anchored" data-anchor-id="model-transfer">Model Transfer</h6>
<ul>
<li><p><a href="https://doi.org/10.1093/jmammal/gyz162">Soley-Guardia, M., Carnaval, A. C., &amp; Anderson, R. P. (2019). Sufficient versus optimal climatic stability during the Late Quaternary: using environmental quality to guide phylogeographic inferences in a Neotropical montane system. Journal of Mammalogy, 100: 1783–1807.</a></p></li>
<li><p><a href="https://besjournals.onlinelibrary.wiley.com/doi/abs/10.1111/j.2041-210X.2011.00170.x">Wenger, S.J. &amp; Olden, J.D. (2012) Assessing transferability of ecological models: an underappreciated aspect of statistical validation. Methods in Ecology and Evolution, 3: 260-267.</a></p></li>
<li><p><a href="https://doi.org/10.1111/ddi.12257">Wright, A. N., Hijmans, R. J., Schwartz, M. W., &amp; Shaffer, H. B. (2015). Multiple sources of uncertainty affect metrics for ranking conservation risk under climate change. Diversity and Distributions, 21(1), 111-122.</a></p></li>
</ul>
</section>
<section id="metadata-1" class="level6">
<h6 class="anchored" data-anchor-id="metadata-1">Metadata</h6>
<ul>
<li><p><a href="https://doi.org/10.1038/s41559-019-0972-5">Feng, X., Park, D. S., Walker, C., Peterson, A. T., Merow, C., &amp; Papeş, M. (2019). A checklist for maximizing reproducibility of ecological niche models. Nature Ecology and Evolution, 3: 1382–1395.</a></p></li>
<li><p><a href="https://doi.org/10.1111/geb.12993">Merow, C., Maitner, B. S., Owens, H. L., Kass, J. M., Enquist, B. J., Jetz, W., &amp; Guralnick, R. (2019). Species’ range model metadata standards: RMMS. Global Ecology and Biogeography, 28: 1912–1924.</a></p></li>
<li><p><a href="https://doi.org/10.1111/ecog.04960">Zurell, D., Franklin, J., König, C., Bouchet, P. J., Dormann, C. F., Elith, J., Fandos, G., Feng, X., Guillera‐Arroita, G., Guisan, A. &amp; Lahoz‐Monfort, J. J. (2020). A standard protocol for reporting species distribution models. Ecography, 43: 1261–1277.</a></p></li>
</ul>
</section>
<section id="r-packages-for-enms" class="level6">
<h6 class="anchored" data-anchor-id="r-packages-for-enms">R Packages for ENMs</h6>
<ul>
<li><p>Baumgartner, J., &amp; Wilson, P. (2021). <em>rmaxent: Tools for working with Maxent in R</em>. R package version 0.8.5.9000, URL: <a href="https://github.com/johnbaums/rmaxent" class="uri">https://github.com/johnbaums/rmaxent</a>.</p></li>
<li><p><a href="http://dx.doi.org/10.7717/peerj.6281">Cobos, M. E., Peterson, A. T., Barve, N., &amp; Osorio-Olvera, L. (2019). kuenm: an R package for detailed development of ecological niche models using Maxent. PeerJ, 7: e6281</a></p></li>
<li><p><a href="https://doi.org/10.1111/ecog.02671">Di Cola, V., Broennimann, O., Petitpierre, B., Breiner, F. T., d’Amen, M., Randin, C., … &amp; Guisan, A. (2017). ecospat: an R package to support spatial analyses and modeling of species niches and distributions. Ecography, 40(6), 774-787.</a></p></li>
<li><p>Lamigueiro, O. P., &amp; Hijmans, R. (2021). rasterVis. R package version 0.50.2. URL: <a href="https://oscarperpinan.github.io/rastervis/" class="uri">https://oscarperpinan.github.io/rastervis/</a>.</p></li>
<li><p><a href="https://doi.org/10.1111/2041-210X.12261">Muscarella, R., Galante, P. J., Soley-Guardia, M., Boria, R. A., Kass, J. M., Uriarte, M. &amp; Anderson, R. P. (2014). ENMeval: An R package for conducting spatially independent evaluations and estimating optimal model complexity for Maxent ecological niche models. Methods in Ecology and Evolution, 5: 1198–1205.</a></p></li>
<li><p><a href="https://doi.org/10.1111/2041-210X.13107">Valavi, R., Elith, J., Lahoz-Monfort, J. J., &amp; Guillera-Arroita G. (2019) blockCV: An R package for generating spatially or environmentally separated folds for k-fold cross-validation of species distribution models. Methods in Ecology and Evolution, 10:225–232.</a></p></li>
<li><p>Wickham H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org" class="uri">https://ggplot2.tidyverse.org</a>.</p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>